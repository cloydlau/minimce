/*!
 * Tiny Advanced Tables plugin
 *
 * Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.
 *
 * Version: 1.0.2-18
 */
!function(){"use strict";function C(){}function T(n){return function(){return n}}function m(n){return n}function i(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}function n(){return u}var c=T(!1),R=T(!0),u={fold:function(n,e){return n()},is:c,isSome:c,isNone:R,getOr:r,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:T(null),getOrUndefined:T(void 0),or:r,orThunk:t,map:n,each:C,bind:n,exists:c,forall:R,filter:n,equals:e,equals_:e,toArray:function(){return[]},toString:T("none()")};function e(n){return n.isNone()}function t(n){return n()}function r(n){return n}function o(r){return function(n){return t=typeof(e=n),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===r;var e,t}}function a(e){return function(n){return typeof n===e}}function l(n,e){return t=n,r=e,-1<B.call(t,r);var t,r}function A(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return!0}return!1}function g(n,e){for(var t=[],r=0;r<n;r++)t.push(e(r));return t}function O(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r}function D(n,e){for(var t=0,r=n.length;t<r;t++){e(n[t],t)}}function w(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t}function E(n,e){if(0===n.length)return[];for(var t=e(n[0]),r=[],o=[],u=0,i=n.length;u<i;u++){var c=n[u],a=e(c);a!==t&&(r.push(o),o=[]),t=a,o.push(c)}return 0!==o.length&&r.push(o),r}function f(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--){e(n[t],t)}}(n,function(n){t=e(t,n)}),t}function N(n,e,t){return D(n,function(n){t=e(t,n)}),t}function s(n,e){return function(n,e,t){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(e(u,r))return W.some(u);if(t(u,r))break}return W.none()}(n,e,c)}function k(n,e){return function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!y(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);L.apply(e,n[t])}return e}(O(n,e))}function b(n,e){for(var t=0,r=n.length;t<r;++t){if(!0!==e(n[t],t))return!1}return!0}function d(n){return[n]}function j(n,e){var t=P.call(n,0);return t.sort(e),t}function v(n){return 0<=(t=(e=n).length-1)&&t<e.length?W.some(e[t]):W.none();var e,t}function p(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return W.none()}var h=function(t){function n(){return o}function e(n){return n(t)}var r=T(t),o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:R,isNone:c,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return h(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?o:u},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(c,function(n){return e(t,n)})}};return o},W={some:h,none:n,from:function(n){return null==n?u:h(n)}},M=o("string"),y=o("array"),S=a("boolean"),I=a("function"),x=a("number"),P=Array.prototype.slice,B=Array.prototype.indexOf,L=Array.prototype.push,q=function(){return(q=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function z(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};function r(n){return Number(e.replace(t,"$"+n))}return Cn(r(1),r(2))}function F(n,e){var t=String(e).toLowerCase();return s(n,function(n){return n.search(t)})}function V(n,e){return-1!==n.indexOf(e)}function _(e){return function(n){return V(n,e)}}function G(n){return window.matchMedia(n).matches}function H(n,e){var t=n.dom;if(1!==t.nodeType)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function X(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount}function U(n,e){return n.dom===e.dom}function $(n,e){for(var t=Un(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}}function K(n){return t=function(n){return n},r=[],$(n,function(n,e){r.push(t(n,e))}),r;var t,r}function Y(n,e,t){return{element:n,rowspan:e,colspan:t}}function J(n,e,t){return{element:n,cells:e,section:t}}function Q(n,e){return{element:n,isNew:e}}function Z(n,e){return{cells:n,section:e}}function nn(n){return n.dom.nodeName.toLowerCase()}function en(n){return n.dom.nodeType}function tn(e){return function(n){return en(n)===e}}function rn(n){return 8===en(n)||"#comment"===nn(n)}function on(n){return Hn.fromDom(n.dom.ownerDocument)}function un(n){return Jn(n)?n:on(n)}function cn(n){return W.from(n.dom.parentNode).map(Hn.fromDom)}function an(n,e){for(var t=I(e)?e:c,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Hn.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}function fn(n){return W.from(n.dom.previousSibling).map(Hn.fromDom)}function ln(n){return W.from(n.dom.nextSibling).map(Hn.fromDom)}function sn(n){return O(n.dom.childNodes,Hn.fromDom)}function mn(n){return e=0,t=n.dom.childNodes,W.from(t[e]).map(Hn.fromDom);var e,t}function dn(n){var e=Zn(n);return Qn(e)?W.some(e):W.none()}function vn(n){return Hn.fromDom(n.dom.host)}function pn(n,e,t){return r=function(n){return H(n,e)},w(an(n,t),r);var r}function hn(n,e){return t=function(n){return H(n,e)},w(sn(n),t);var t}function gn(n,e){return t=e,o=void 0===(r=n)?document:r.dom,X(o)?[]:O(o.querySelectorAll(t),Hn.fromDom);var t,r,o}var wn,bn,yn,Sn,xn=function(){return Cn(0,0)},Cn=function(n,e){return{major:n,minor:e}},Tn={nu:Cn,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?xn():z(n,t)},unknown:xn},Rn=function(n,t){return F(n,t).map(function(n){var e=Tn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},An=function(n,t){return F(n,t).map(function(n){var e=Tn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},On=(wn=/^\s+|\s+$/g,function(n){return n.replace(wn,"")}),Dn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,En=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return V(n,"edge/")&&V(n,"chrome")&&V(n,"safari")&&V(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Dn],search:function(n){return V(n,"chrome")&&!V(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return V(n,"msie")||V(n,"trident")}},{name:"Opera",versionRegexes:[Dn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:_("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:_("firefox")},{name:"Safari",versionRegexes:[Dn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(V(n,"safari")||V(n,"mobile/"))&&V(n,"applewebkit")}}],Nn=[{name:"Windows",search:_("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return V(n,"iphone")||V(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:_("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:_("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:_("linux"),versionRegexes:[]},{name:"Solaris",search:_("sunos"),versionRegexes:[]},{name:"FreeBSD",search:_("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:_("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],kn={browsers:T(En),oses:T(Nn)},jn="Firefox",Wn=function(n){function e(n){return function(){return t===n}}var t=n.current,r=n.version;return{current:t,version:r,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(jn),isSafari:e("Safari")}},Mn={unknown:function(){return Wn({current:void 0,version:Tn.unknown()})},nu:Wn,edge:T("Edge"),chrome:T("Chrome"),ie:T("IE"),opera:T("Opera"),firefox:T(jn),safari:T("Safari")},In="Windows",Pn="Android",Bn="Solaris",Ln="FreeBSD",qn="ChromeOS",zn=function(n){function e(n){return function(){return t===n}}var t=n.current,r=n.version;return{current:t,version:r,isWindows:e(In),isiOS:e("iOS"),isAndroid:e(Pn),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(Bn),isFreeBSD:e(Ln),isChromeOS:e(qn)}},Fn={unknown:function(){return zn({current:void 0,version:Tn.unknown()})},nu:zn,windows:T(In),ios:T("iOS"),android:T(Pn),linux:T("Linux"),osx:T("OSX"),solaris:T(Bn),freebsd:T(Ln),chromeos:T(qn)},Vn=function(n,e){var t,r,o,u,i,c,a,f,l,s,m,d,v=kn.browsers(),p=kn.oses(),h=Rn(v,n).fold(Mn.unknown,Mn.nu),g=An(p,n).fold(Fn.unknown,Fn.nu);return{browser:h,os:g,deviceType:(r=h,o=n,u=e,i=(t=g).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),f=a||u("(pointer:coarse)"),l=i||!c&&a&&u("(min-device-width:768px)"),s=c||a&&!l,m=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),d=!s&&!l&&!m,{isiPad:T(i),isiPhone:T(c),isTablet:T(l),isPhone:T(s),isTouch:T(f),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:T(m),isDesktop:T(d)})}},_n=(Sn=!(bn=function(){return Vn(navigator.userAgent,G)}),function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Sn||(Sn=!0,yn=bn.apply(null,n)),yn}),Gn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},Hn={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Gn(t.childNodes[0])},fromTag:function(n,e){var t=(e||document).createElement(n);return Gn(t)},fromText:function(n,e){var t=(e||document).createTextNode(n);return Gn(t)},fromDom:Gn,fromPoint:function(n,e,t){return W.from(n.dom.elementFromPoint(e,t)).map(Gn)}},Xn=H,Un=Object.keys,$n=["tfoot","thead","tbody","colgroup"],Kn=("undefined"!=typeof window||Function("return this;")(),tn(1)),Yn=tn(3),Jn=tn(9),Qn=tn(11),Zn=I(Element.prototype.attachShadow)&&I(Node.prototype.getRootNode)?function(n){return Hn.fromDom(n.dom.getRootNode())}:un,ne=function(n){var e=Yn(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return dn(Hn.fromDom(e)).fold(function(){return o.body.contains(e)},(t=ne,r=vn,function(n){return t(r(n))}))},ee=function(n,e){var t=[];return D(sn(n),function(n){e(n)&&(t=t.concat([n])),t=t.concat(ee(n,e))}),t};function te(n,e,t){for(var r=n.dom,o=I(t)?t:c;r.parentNode;){r=r.parentNode;var u=Hn.fromDom(r);if(e(u))return W.some(u);if(o(u))break}return W.none()}function re(n,e,t){return te(n,function(n){return H(n,e)},t)}function oe(n,e){return t=function(n){return H(n,e)},s(n.dom.childNodes,function(n){return t(Hn.fromDom(n))}).map(Hn.fromDom);var t}function ue(n,e){return t=e,o=void 0===(r=n)?document:r.dom,X(o)?W.none():W.from(o.querySelector(t)).map(Hn.fromDom);var t,r,o}function ie(n,e,t){var r,o,u,i;return r=re,i=t,function(n,e){return H(n,e)}(o=n,u=e)?W.some(o):I(i)&&i(o)?W.none():r(o,u,i)}function ce(n,e,t){if(!(M(t)||S(t)||x(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}function ae(n,e,t){ce(n.dom,e,t)}function fe(n,e){var t=n.dom;$(e,function(n,e){ce(t,e,n)})}function le(n,e){var t=n.dom.getAttribute(e);return null===t?void 0:t}function se(n,e){return W.from(le(n,e))}function me(n,e){n.dom.removeAttribute(e)}function de(n){return N(n.dom.attributes,function(n,e){return n[e.name]=e.value,n},{})}function ve(n){return void 0!==n.style&&I(n.style.getPropertyValue)}function pe(n,e,t){if(!M(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);ve(n)&&n.style.setProperty(e,t)}function he(n,e,t){var r=n.dom;pe(r,e,t)}function ge(n,e){var t=n.dom;$(e,function(n,e){pe(t,e,n)})}function we(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||ne(n)?r:Ve(t,e)}function be(n,e){var t=n.dom,r=Ve(t,e);return W.from(r).filter(function(n){return 0<n.length})}function ye(n,e){var t,r,o=n.dom;r=e,ve(t=o)&&t.style.removeProperty(r),se(n,"style").map(On).is("")&&me(n,"style")}function Se(n,e,t){return void 0===t&&(t=0),se(n,e).map(function(n){return parseInt(n,10)}).getOr(t)}function xe(n){return 1<Se(n,"colspan",1)}function Ce(n,e){return Ge(n,e,R)}function Te(n,e){return function(n,e,t){if(void 0===t&&(t=c),t(e))return W.none();if(l(n,nn(e)))return W.some(e);return re(e,n.join(","),function(n){return H(n,"table")||t(n)})}(["td","th"],n,e)}function Re(n){return Ce(n,"th,td")}function Ae(n){return H(n,"colgroup")?hn(n,"col"):k(He(n),function(n){return hn(n,"col")})}function Oe(n,e){return ie(n,"table",e)}function De(n){return cn(n).map(function(n){var e=nn(n);return l($n,e)?e:"tbody"}).getOr("tbody")}function Ee(n){var t,e=Ce(n,"tr"),r=function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var u=arguments[e],i=0,c=u.length;i<c;i++,o++)r[o]=u[i];return r}(He(n),e);return t=De,O(r,function(n){if("colgroup"!==nn(n))return e=O(Re(n),function(n){var e=Se(n,"rowspan",1),t=Se(n,"colspan",1);return Y(n,e,t)}),J(n,e,t(n));var e=O(Ae(n),function(n){var e=Se(n,"span",1);return Y(n,1,e)});return J(n,e,"colgroup")})}function Ne(n,e){return n+","+e}function ke(n){var a={},e=[],t={},r=0,f=0,l=0;return D(n,function(n){if("colgroup"===n.section)o={},u=0,D(n.cells,function(t){var r=t.colspan;g(r,function(n){var e=u+n;o[e]={element:t.element,colspan:r,column:e}}),u+=r}),t=o;else{var c=[];D(n.cells,function(n){for(var e=0;void 0!==a[Ne(l,e)];)e++;for(var t={element:n.element,rowspan:n.rowspan,colspan:n.colspan,row:l,column:e},r=0;r<n.colspan;r++)for(var o=0;o<n.rowspan;o++){var u=e+r,i=Ne(l+o,u);a[i]=t,f=Math.max(f,u+1)}c.push(t)}),r++,e.push(J(n.element,c,n.section)),l++}var o,u}),{grid:{rows:r,columns:f},access:a,all:e,columns:t}}function je(n,e){return e.column>=n.startCol&&e.column+e.colspan-1<=n.finishCol&&e.row>=n.startRow&&e.row+e.rowspan-1<=n.finishRow}function We(n,e,t){var r=Ue.findItem(n,e,U),o=Ue.findItem(n,t,U);return r.bind(function(r){return o.map(function(n){return e=r,t=n,{startRow:Math.min(e.row,t.row),startCol:Math.min(e.column,t.column),finishRow:Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,t.column+t.colspan-1)};var e,t})})}function Me(e,n,t){return We(e,n,t).bind(function(n){return function(n,e){for(var t=!0,r=i(je,e),o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++)t=t&&Ue.getAt(n,o,u).exists(r);return t?W.some(e):W.none()}(e,n)})}function Ie(n,e,t){var r=$e(n);return Me(r,e,t)}function Pe(e,t){cn(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})}function Be(n,e){ln(n).fold(function(){cn(n).each(function(n){Ke(n,e)})},function(n){Pe(n,e)})}function Le(e,t){mn(e).fold(function(){Ke(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})}function qe(n,e){Pe(n,e),Ke(e,n)}function ze(e,n){D(n,function(n){Ke(e,n)})}function Fe(n){n.dom.textContent="",D(sn(n),function(n){Ye(n)})}var Ve=function(n,e){return ve(n)?n.style.getPropertyValue(e):""},_e=T(10),Ge=function(n,e,t){return k(sn(n),function(n){return H(n,e)?t(n)?[n]:[]:Ge(n,e,t)})},He=function(n){return Oe(n).fold(T([]),function(n){return hn(n,"colgroup")})},Xe=function(n,e){var t=k(n.all,function(n){return n.cells});return w(t,e)},Ue={fromTable:function(n){var e=Ee(n);return ke(e)},generate:ke,getAt:function(n,e,t){var r=n.access[Ne(e,t)];return void 0!==r?W.some(r):W.none()},findItem:function(n,e,t){var r=Xe(n,function(n){return t(e,n.element)});return 0<r.length?W.some(r[0]):W.none()},filterItems:Xe,justCells:function(n){return k(n.all,function(n){return n.cells})},justColumns:function(n){return K(n.columns)},hasColumns:function(n){return 0<Un(n.columns).length},getColumnAt:function(n,e){return W.from(n.columns[e])}},$e=Ue.fromTable,Ke=function(n,e){n.dom.appendChild(e.dom)},Ye=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)};function Je(n){return tt.get(n)}function Qe(n,e){return tt.set(n,e)}var Ze,nt,et,tt=(Ze=Yn,nt="text",{get:function(n){if(!Ze(n))throw new Error("Can only get "+nt+" value of a "+nt+" node");return et(n).getOr("")},getOption:et=function(n){return Ze(n)?W.from(n.dom.nodeValue):W.none()},set:function(n,e){if(!Ze(n))throw new Error("Can only set raw "+nt+" value of a "+nt+" node");n.dom.nodeValue=e}}),rt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function ot(n){return re(n,"table")}function ut(n,e,t){return ue(n,e).bind(function(r){return ue(n,t).bind(function(e){return t=ot,yt(St,function(n,e){return t(e)},[r,e]).map(function(n){return{first:r,last:e,table:n}});var t})})}function it(n,e){return 0<(t=gn(n,e)).length?W.some(t):W.none();var t}function ct(u,n,e){return ut(u,n,e).bind(function(t){function n(n){return U(u,n)}var e="thead,tfoot,tbody,table",r=re(t.first,e,n),o=re(t.last,e,n);return r.bind(function(e){return o.bind(function(n){return U(e,n)?Ie(t.table,t.first,t.last):W.none()})})})}function at(n,e,t,r){return n.fold(e,t,r)}function ft(n){return parseInt(n,10)}function lt(n,e){var t=n-e;return 0==t?0:0<t?1:-1}function st(n,e,t){return{major:n,minor:e,patch:t}}function mt(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?st(ft(e[1]),ft(e[2]),ft(e[3])):st(0,0,0)}function dt(n,e){return!!n&&-1===function(n,e){var t=lt(n.major,e.major);if(0!==t)return t;var r=lt(n.minor,e.minor);if(0!==r)return r;var o=lt(n.patch,e.patch);return 0!==o?o:0}(mt([(t=n).majorVersion,t.minorVersion].join(".").split(".").slice(0,3).join(".")),mt(e));var t}function vt(n){var e=n;return{get:function(){return e},set:function(n){e=n}}}function pt(n){return n.slice(0).sort()}function ht(n){return{element:n,colspan:Se(n,"colspan",1),rowspan:Se(n,"rowspan",1)}}function gt(n,e){return n.cells[e]}var wt=function(r,o,n,e){var t=o(r,n);return f(e,function(n,e){var t=o(r,e);return bt(r,n,t)},t)},bt=function(e,n,t){return n.bind(function(n){return t.filter(i(e.eq,n))})},yt=function(n,e,t){return 0<t.length?wt(n,e,(r=t)[0],r.slice(1)):W.none();var r},St={up:T({selector:re,closest:ie,predicate:te,all:an}),down:T({selector:gn,predicate:ee}),styles:T({get:we,getRaw:be,set:he,remove:ye}),attrs:T({get:le,set:ae,remove:me,copyTo:function(n,e){var t=de(n);fe(e,t)}}),insert:T({before:Pe,after:Be,afterAll:function(r,o){D(o,function(n,e){var t=0===e?r:o[e-1];Be(t,n)})},append:Ke,appendAll:ze,prepend:Le,wrap:qe}),remove:T({unwrap:function(n){var e,t=sn(n);0<t.length&&(e=n,D(t,function(n){Pe(e,n)})),Ye(n)},remove:Ye}),create:T({nu:Hn.fromTag,clone:function(n){return Hn.fromDom(n.dom.cloneNode(!1))},text:Hn.fromText}),query:T({comparePosition:function(n,e){return n.dom.compareDocumentPosition(e.dom)},prevSibling:fn,nextSibling:ln}),property:T({children:sn,name:nn,parent:cn,document:function(n){return un(n).dom},isText:Yn,isComment:rn,isElement:Kn,getText:Je,setText:Qe,isBoundary:function(n){return!!Kn(n)&&("body"===nn(n)||l(rt,nn(n)))},isEmptyTag:function(n){return!!Kn(n)&&l(["br","img","hr","input"],nn(n))},isNonEditable:function(n){return Kn(n)&&"false"===le(n,"contenteditable")}}),eq:U,is:Xn},xt=function(i){if(!y(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return D(i,function(n,r){var e=Un(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],u=n[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!y(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var n=arguments.length;if(n!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(n){var e=Un(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!b(c,function(n){return l(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){console.log(n,{constructors:c,constructor:o,params:t})}}}}),t}([{none:[]},{multiple:["elements"]},{single:["element"]}]),Ct=xt.none,Tt=xt.multiple,Rt=xt.single,At=function(r,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");var t;return function(e,n){if(!y(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");D(n,function(n){if(!M(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})}("required",o),t=pt(o),s(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}),function(e){var t=Un(e);b(o,function(n){return l(t,n)})||function(n,e){throw new Error("All required keys ("+pt(n).join(", ")+") were not specified. Specified keys were: "+pt(e).join(", ")+".")}(o,t),r(o,t);var n=w(o,function(n){return!u.validate(e[n],n)});return 0<n.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+pt(n).join(", ")+") were not.")}(n,u.label),e}}(function(e,n){var t=w(n,function(n){return!l(e,n)});0<t.length&&function(n){throw new Error("Unsupported keys for object: "+pt(n).join(", "))}(t)},["cell","row","replace","gap","col","colgroup"],{validate:I,label:"function"}),Ot=function(e,t){void 0===t&&(t=ht),At(e);function r(n){return function(n){switch(nn(n.element)){case"col":return e.col(n);default:return e.cell(n)}}(t(n))}function o(n){var e=r(n);return u.get().isNone()&&u.set(W.some(e)),i=W.some({item:n,replacement:e}),e}var u=vt(W.none()),i=W.none();return{getOrInit:function(e,t){return i.fold(function(){return o(e)},function(n){return t(e,n.item)?n.replacement:o(e)})},cursor:u.get}};function Dt(r,o){function n(n){var e=o(n);if(e<=0||null===e){var t=we(n,r);return parseFloat(t)||0}return e}function u(o,n){return N(n,function(n,e){var t=we(o,e),r=void 0===t?0:parseInt(t,10);return isNaN(r)?n:n+r},0)}return{set:function(n,e){if(!x(e)&&!e.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+e);var t=n.dom;ve(t)&&(t.style[r]=e+"px")},get:n,getOuter:n,aggregate:u,max:function(n,e,t){var r=u(n,t);return r<e?e-r:0}}}function Et(n){return $r.get(n)}function Nt(n){return $r.getOuter(n)}function kt(t){var n=t.grid,e=g(n.columns,m),r=g(n.rows,m);return O(e,function(e){return Kr(function(){return k(r,function(n){return Ue.getAt(t,n,e).filter(function(n){return n.column===e}).toArray()})},function(n){return 1===n.colspan},function(){return Ue.getAt(t,0,e)})})}function jt(r,o){if(o<0||o>=r.length-1)return W.none();var n=r[o].fold(function(){var n,e,t=(n=r.slice(0,o),(e=P.call(n,0)).reverse(),e);return p(t,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return W.some({value:n,delta:0})}),e=r[o+1].fold(function(){var n=r.slice(o+1);return p(n,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return W.some({value:n,delta:1})});return n.bind(function(t){return e.map(function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e})})}function Wt(n){return Jr.getOuter(n)}function Mt(n,e){return void 0!==n?n:void 0!==e?e:0}function It(n){var e=n.dom.ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom)return Zr(t.offsetLeft,t.offsetTop);var u=Mt(null==r?void 0:r.pageYOffset,o.scrollTop),i=Mt(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Mt(o.clientTop,t.clientTop),a=Mt(o.clientLeft,t.clientLeft);return no(n).translate(i-a,u-c)}function Pt(n,e){return{row:n,y:e}}function Bt(n,e){return{col:n,x:e}}function Lt(n){return It(n).left+Nt(n)}function qt(n){return It(n).left}function zt(n,e){return Bt(n,qt(e))}function Ft(n,e){return Bt(n,Lt(e))}function Vt(n){return It(n).top}function _t(n,e){return Pt(n,Vt(e))}function Gt(n,e){return Pt(n,Vt(e)+Wt(e))}function Ht(t,e,r){if(0===r.length)return[];var n=O(r.slice(1),function(n,e){return n.map(function(n){return t(e,n)})}),o=r[r.length-1].map(function(n){return e(r.length-1,n)});return n.concat([o])}function Xt(){var n=_n().browser;return n.isIE()||n.isEdge()}function Ut(n,e,t){return r=we(n,e),o=t,u=parseFloat(r),isNaN(u)?o:u;var r,o,u}function $t(n){return Xt()?(t=(e=n).dom.getBoundingClientRect().width,"border-box"===we(e,"box-sizing")?t:t-Ut(e,"padding-left",0)-Ut(e,"padding-right",0)-(Ut(e,"border-left-width",0)+Ut(e,"border-right-width",0))):Ut(n,"width",Et(n));var e,t}function Kt(n,e){he(n,"width",e+"px")}function Yt(n,e){he(n,"width",e+"%")}function Jt(n){return be(n,"width").fold(function(){return W.from(le(n,"width"))},function(n){return W.some(n)})}function Qt(n,e){return n/e.pixelWidth()*100}function Zt(e,t){return Jt(e).fold(function(){var n=Et(e);return Qt(n,t)},function(n){return function(n,e,t){var r=uo.exec(e);if(null!==r)return parseFloat(r[1]);var o=$t(n);return Qt(o,t)}(e,n,t)})}function nr(e,t){return Jt(e).fold(function(){return $t(e)},function(n){return function(n,e,t){var r=io.exec(e);if(null!==r)return parseInt(r[1],10);var o=uo.exec(e);if(null===o)return $t(n);var u=parseFloat(o[1]);return u/100*t.pixelWidth()}(e,n,t)})}function er(n,e,t,r,o,u){return n.filter(r).fold(function(){return u(jt(t,e))},function(n){return o(n)})}function tr(n,e,i,c,a){var t,r,f=kt(n),o=Ue.hasColumns(n)?(t=n,O(Ue.justColumns(t),function(n){return W.from(n.element)})):f,l=[W.some(oo(e))].concat(O(ro(f,e),function(n){return n.map(function(n){return n.x})})),s=(r=xe,function(n){return!r(n)});return O(o,function(n,u){return er(n,u,l,s,function(n){if(!fo(r=n)||be(r,"width").isSome())return i(n,a);var e,t,r,o=(e=f[u],t=m,null!=e?t(e):W.none());return er(o,u,l,s,function(n){return c(W.some(Et(n)))},c)},c)})}function rr(n,e,t){return tr(n,e,nr,function(n){return n.getOrThunk(t.minCellWidth)},t)}function or(t){function n(){return Et(t)}var e=T(0);return{width:n,pixelWidth:n,getWidths:function(n,e){return rr(n,t,e)},getCellDelta:e,singleColumnWidth:T([0]),minCellWidth:e,setElementWidth:C,adjustTableWidth:C,isRelative:!0,label:"none"}}function ur(n,r){var o=vt(parseFloat(n)),u=vt(Et(r));return{width:o.get,pixelWidth:u.get,getWidths:function(n,e){return tr(n,r,Zt,function(n){return n.fold(function(){return t.minCellWidth()},function(n){return n/t.pixelWidth()*100})},t=e);var t},getCellDelta:function(n){return n/u.get()*100},singleColumnWidth:function(n,e){return[100-n]},minCellWidth:function(){return _e()/u.get()*100},setElementWidth:Yt,adjustTableWidth:function(n){var e=o.get(),t=e+n/100*e;Yt(r,t),o.set(t),u.set(Et(r))},isRelative:!0,label:"percent"}}function ir(n,t){var r=vt(n),o=r.get;return{width:o,pixelWidth:o,getWidths:function(n,e){return rr(n,t,e)},getCellDelta:m,singleColumnWidth:function(n,e){return[Math.max(_e(),n+e)-n]},minCellWidth:_e,setElementWidth:Kt,adjustTableWidth:function(n){var e=o()+n;Kt(t,e),r.set(e)},isRelative:!1,label:"pixel"}}function cr(n,e){return Hn.fromDom(n.dom.cloneNode(e))}function ar(n,e){var t,r,o,u,i=(t=n,r=e,o=Hn.fromTag(r),u=de(t),fe(o,u),o),c=sn(cr(n,!0));return ze(i,c),i}function fr(n,e,t,r){t===r?me(n,e):ae(n,e,t)}function lr(n,e,t){v(hn(n,e)).fold(function(){return Le(n,t)},function(n){return Be(n,t)})}function sr(c,n){function a(n){return O(n,function(n){n.isNew&&r.push(n.element);var e=n.element;return Fe(e),D(n.cells,function(n){n.isNew&&o.push(n.element),fr(n.element,"colspan",n.colspan,1),fr(n.element,"rowspan",n.rowspan,1),Ke(e,n.element)}),e})}function f(n){return k(n,function(n){return O(n.cells,function(n){return fr(n.element,"span",n.colspan,1),n.element})})}function t(n,e){var t,r,o,u=(o=oe(t=c,r=e).getOrThunk(function(){var n=Hn.fromTag(r,on(t).dom);return"thead"===r?lr(t,"caption,colgroup",n):"colgroup"===r?lr(t,"caption",n):Ke(t,n),n}),Fe(o),o),i=("colgroup"===e?f:a)(n);ze(u,i)}function e(n,e){0<n.length?t(n,e):oe(c,e).each(Ye)}var r=[],o=[],u=[],i=[],l=[],s=[];return D(n,function(n){switch(n.section){case"thead":u.push(n);break;case"tbody":i.push(n);break;case"tfoot":l.push(n);break;case"colgroup":s.push(n)}}),e(s,"colgroup"),e(u,"thead"),e(i,"tbody"),e(l,"tfoot"),{newRows:r,newCells:o}}function mr(n,e){var t=le(n,e);return void 0===t||""===t?[]:t.split(" ")}function dr(n){return void 0!==n.dom.classList}function vr(n,e){return o=e,u=mr(t=n,r="class").concat([o]),ae(t,r,u.join(" ")),1;var t,r,o,u}function pr(n,e){dr(n)?n.dom.classList.add(e):vr(n,e)}function hr(t,n,r){var o=t.origin();D(n,function(n){n.each(function(n){var e=r(o,n);pr(e,mo),Ke(t.parent(),e)})})}function gr(n,e,f,l){hr(n,e,function(n,e){var t,r,o,u,i,c,a=(t=e.col,r=e.x-n.left,o=f.top-n.top,u=7,i=l,c=Hn.fromTag("div"),ge(c,{position:"absolute",left:r-u/2+"px",top:o+"px",height:i+"px",width:u+"px"}),fe(c,{"data-column":t,role:"presentation"}),c);return pr(a,po),a})}function wr(n,e,f,l){hr(n,e,function(n,e){var t,r,o,u,i,c,a=(t=e.row,r=f.left-n.left,o=e.y-n.top,u=l,i=7,c=Hn.fromTag("div"),ge(c,{position:"absolute",left:r+"px",top:o-i/2+"px",height:i+"px",width:u+"px"}),fe(c,{"data-row":t,role:"presentation"}),c);return pr(a,vo),a})}function br(n,e,t,r,o){var u,i=It(t),c=e.isResizable,a=0<r.length?eo(r,t):[],f=0<a.length?(u=c,k(n.all,function(n,e){return u(n.element)?[e]:[]})):[],l=w(a,function(n,e){return A(f,function(n){return e===n})});wr(e,l,i,Nt(t));var s,m,d,v=0<o.length?ro(o,t):[],p=0<v.length?(m=c,d=[],g((s=n).grid.columns,function(n){Ue.getColumnAt(s,n).map(function(n){return n.element}).forall(m)&&d.push(n)}),w(d,function(e){var n=Ue.filterItems(s,function(n){return n.column===e});return b(n,function(n){return m(n.element)})})):[],h=w(v,function(n,e){return A(p,function(n){return e===n})});gr(e,h,i,Wt(t))}function yr(n,e){var t,r,o,u,i;if(t=gn(n.parent(),"."+mo),D(t,Ye),n.isResizable(e)){var c=Ue.fromTable(e),a=(o=(r=c).grid,u=g(o.rows,m),i=g(o.columns,m),O(u,function(e){return Kr(function(){return k(i,function(n){return Ue.getAt(r,e,n).filter(function(n){return n.row===e}).fold(T([]),function(n){return[n]})})},function(n){return 1===n.rowspan},function(){return Ue.getAt(r,e,0)})})),f=kt(c);br(c,n,e,a,f)}}function Sr(n,e){if(0===n.length)return 0;var t=n[0];return function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return W.some(t)}return W.none()}(n,function(n){return!e(t.element,n.element)}).fold(function(){return n.length},function(n){return n})}function xr(n,e,t,r){var o,u=n[e].cells.slice(t),i=Sr(u,r),c=(o=t,O(n,function(n){return gt(n,o)}).slice(e));return{colspan:i,rowspan:Sr(c,r)}}function Cr(o,u){var i=O(o,function(n){return O(n.cells,c)});return O(o,function(n,r){return{details:k(n.cells,function(n,e){if(!1!==i[r][e])return[];var t=xr(o,r,e,u);return function(n,e,t,r){for(var o=n;o<n+t;o++)for(var u=e;u<e+r;u++)i[o][u]=!0}(r,e,t.rowspan,t.colspan),[{element:n.element,rowspan:t.rowspan,colspan:t.colspan,isNew:n.isNew}]}),section:n.section}})}function Tr(n,e){return function(n,e,t){var r=[];if(Ue.hasColumns(n)){var o=O(Ue.justColumns(n),function(n){return Q(n.element,t)});r.push(Z(o,"colgroup"))}for(var u=0;u<n.grid.rows;u++){for(var i=[],c=0;c<n.grid.columns;c++){var a=Ue.getAt(n,u,c).map(function(n){return Q(n.element,t)}).getOrThunk(function(){return Q(e.gap(),!0)});i.push(a)}var f=Z(i,n.all[u].section);r.push(f)}return r}(n,e,!1)}function Rr(n,r){return O(n,function(n){var e,t=(e=n.details,p(e,function(n){return cn(n.element).map(function(n){var e=cn(n).isNone();return Q(n,e)})}).getOrThunk(function(){return Q(r.row(),!0)}));return{element:t.element,cells:n.details,section:n.section,isNew:t.isNew}})}function Ar(n,e){return p(n.all,function(n){return s(n.cells,function(n){return U(e,n.element)})})}function Or(a,e,f,l,s){return function(r,o,n,i,u){var c=Ue.fromTable(o);return e(c,n).map(function(n){var e,t,r,o=Tr(c,i),u=a(o,n,U,s(i));return{grid:(e=u.grid,t=i,r=Cr(e,U),Rr(r,t)),cursor:u.cursor}}).fold(function(){return W.none()},function(n){var e=sr(o,n.grid),t=W.from(u).getOrThunk(function(){return lo(o)});return f(o,n.grid,t),l(o),yr(r,o),W.some({cursor:n.cursor,newRows:e.newRows,newCells:e.newCells})})}}function Dr(e,n){return Te(n.element).bind(function(n){return Ar(e,n)})}function Er(e,n){var t=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e}(O(n.selection,function(n){return Te(n).bind(function(n){return Ar(e,n)})}));return 0<t.length?W.some(t):W.none()}function Nr(n){return e=n,tt.getOption(e).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("Â ")}).isSome();var e}function kr(n){return Nr(n)||l(ho,nn(n))}function jr(n){return o=kr,(u=function(n){for(var e=0;e<n.childNodes.length;e++){var t=Hn.fromDom(n.childNodes[e]);if(o(t))return W.some(t);var r=u(n.childNodes[e]);if(r.isSome())return r}return W.none()})(n.dom);var o,u}function Wr(){var n=Hn.fromTag("td");return Ke(n,Hn.fromTag("br")),n}function Mr(){return Hn.fromTag("colgroup")}function Ir(n,e,t){var r=ar(n,e);return $(t,function(n,e){null===n?me(r,e):ae(r,e,n)}),r}function Pr(r,o,u){return jr(r).map(function(n){var e=u.join(","),t=pn(n,e,function(n){return U(n,r)});return f(t,function(n,e){var t=cr(e,!1);return me(t,"contenteditable"),Ke(n,t),t},o)}).getOr(o)}function Br(c,n,a){function f(n,e){var t,r,o,u;t=n.element,r=e,o=t.dom,u=r.dom,ve(o)&&ve(u)&&(u.style.cssText=o.style.cssText),ye(e,"height"),1!==n.colspan&&ye(n.element,"width")}var e;return{col:function(n){var e=on(n.element),t=Hn.fromTag(nn(n.element),e.dom);return f(n,t),c(n.element,t),t},colgroup:Mr,row:(e=n,function(){return Hn.fromTag("tr",e.dom)}),cell:function(n){var r,o,e=on(n.element),t=Hn.fromTag(nn(n.element),e.dom),u=a.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),i=0<u.length?Pr(n.element,t,u):t;return Ke(i,Hn.fromTag("br")),f(n,t),r=n.element,o=t,$(go,function(e,t){return se(r,t).filter(function(n){return l(e,n)}).each(function(n){return ae(o,t,n)})}),c(n.element,t),t},replace:Ir,gap:Wr}}function Lr(n){return n.dom.textContent}function qr(n){return Hn.fromDom(n.getBody())}function zr(n){function e(n){return me(n,"data-mce-style")}me(n,"data-mce-style"),D(Re(n),e),D(Ae(n),e)}function Fr(n){var e=parseFloat(n);return isNaN(e)?W.none():W.some(e)}function Vr(n,e){return n<e?-1:e<n?1:0}function _r(e,t){return n=Fr(e),r=Fr(t),o=Vr,(n.isSome()&&r.isSome()?W.some(o(n.getOrDie(),r.getOrDie())):W.none()).getOrThunk(function(){return n=t,e.localeCompare(n);var n});var n,r,o}var Gr,Hr,Xr,Ur,$r=Dt("width",function(n){return n.dom.offsetWidth}),Kr=function(n,e,t){var r=n();return s(r,e).orThunk(function(){return W.from(r[0]).orThunk(t)}).map(function(n){return n.element})},Yr=function(n){return"rtl"===we(n,"direction")?"rtl":"ltr"},Jr=Dt("height",function(n){var e=n.dom;return ne(n)?e.getBoundingClientRect().height:e.offsetHeight}),Qr=function(t,r){return{left:t,top:r,translate:function(n,e){return Qr(t+n,r+e)}}},Zr=Qr,no=function(n){var e,t=n.dom,r=t.ownerDocument.body;return r===t?Zr(r.offsetLeft,r.offsetTop):ne(n)?(e=t.getBoundingClientRect(),Zr(e.left,e.top)):Zr(0,0)},eo=function(n){return Ht(_t,Gt,n)},to=(Gr={delta:m,edge:qt,positions:function(n){return Ht(zt,Ft,n)}},Hr={delta:function(n){return-n},edge:Lt,positions:function(n){return Ht(Ft,zt,n)}},function(n){return"rtl"===Yr(n)?Hr:Gr}),ro=function(n,e){return to(e).positions(n,e)},oo=function(n){return to(n).edge(n)},uo=/(\d+(\.\d+)?)%/,io=/(\d+(\.\d+)?)px|em/,co=T(uo),ao=T(io),fo=(Xr="col",function(n){return Kn(n)&&nn(n)===Xr}),lo=function(e){return Jt(e).fold(function(){return or(e)},function(n){return function(n,e){var t=co().exec(e);if(null!==t)return ur(t[1],n);var r=ao().exec(e);if(null!==r){var o=parseInt(r[1],10);return ir(o,n)}var u=Et(n);return ir(u,n)}(e,n)})},so=(Ur="ephox-snooker".replace(/\./g,"-"),{resolve:function(n){return Ur+"-"+n}}).resolve,mo=so("resizer-bar"),vo=so("resizer-rows"),po=so("resizer-cols"),ho=["img","br"],go={scope:["row","col"]},wo={structure:!0,style:!1};function bo(d,v){function e(f,l,s,m){return function(n,e){zr(n);var t,r,o,u,i=(t=v().resizeHandler.lazyWire(),r=t.parent(),o=t.view(),u=t.origin(),I(r.dom)?{origin:T(q(q({},u),{left:u.left(),top:u.top()})),parent:T(q(q({},r),{dom:r.dom()})),view:T(q(q({},o),{dom:o.dom()})),isResizable:R}:t),c=Hn.fromDom(d.getDoc()),a=Br(s,c,y);return l(n)?f(i,n,e,a).bind(function(n){return D(n.newRows,function(n){var e,t;e=d,t=n.dom,e.fire("newrow",{node:t})}),D(n.newCells,function(n){var e,t;e=d,t=n.dom,e.fire("newcell",{node:t})}),n.cursor.map(function(n){var e=d.dom.createRng();return e.setStart(n.dom,0),e.setEnd(n.dom,0),{rng:e,effect:m}})}):W.none()}}function a(n,e,t){return{grid:n,cursor:(r=n,o=e,u=t,W.from(r[o]).bind(function(n){return W.from(n.cells[u]).bind(function(n){return W.from(n.element)})}))};var r,o,u}function l(n,r,o,u){var e=E(n,function(n){return n.section}),t=O(e,function(n){return E(n,function(n){return nn(gt(n,r).element)})});return k(t,function(n){return k(n,function(n){return"th"===nn(gt(n[0],r).element)?n:(e=O(n,function(n){var e=gt(n,r);return{row:n,text:W.from(Lr(e.element)).getOr("")}}),t=j(e,function(n,e){var t=o(n.text,e.text);return u?t:-1*t}),O(t,function(n){return n.row}));var e,t})})}function s(n,e,o,u){var t=n[e].cells,r=O(t,function(n){return W.from(Lr(n.element)).getOr("")}),i=O(n,function(n){return{zippedCells:O(n.cells,function(n,e){return{cell:n,reference:t[e],referenceText:r[e]}}),section:n.section}});return O(i,function(n){var e=E(n.zippedCells,function(n){return nn(n.reference.element)}),t=k(e,function(n){return"th"===nn(n[0].reference.element)?n:j(n,function(n,e){var t=o(n.referenceText,e.referenceText);return u?t:-1*t})}),r=O(t,function(n){return n.cell});return Z(r,n.section)})}function m(n,e,t,r,o){var u=n.slice(0,e),i=n.slice(e,t+1);return{beforeRows:u,afterRows:n.slice(t+1,n.length),selectionGridBefore:i.map(function(n){return{cells:n.cells.slice(0,r),section:n.section}}),selectionGrid:i.map(function(n){return{cells:n.cells.slice(r,o+1),section:n.section}}),selectionGridAfter:i.map(function(n){return{cells:n.cells.slice(o+1,n.cells.length),section:n.section}})}}function p(o,n){var e=O(n,function(n,e){var t=o.selectionGridBefore[e].cells,r=o.selectionGridAfter[e].cells;return{cells:t.concat(n.cells).concat(r),section:n.section}});return o.beforeRows.concat(e).concat(o.afterRows)}function f(n,e,t,r,o,u,i,c){var a=m(n,t,r,o,u),f=l(a.selectionGrid,e-o,i,c);return p(a,f)}function h(n,e,t,r,o,u,i,c){var a=m(n,t,r,o,u),f=s(a.selectionGrid,e-t,i,c);return p(a,f)}function g(n){return N(n,function(n,e){return A(n,function(n){return n.row===e.row})?n:n.concat([e])},[]).sort(function(n,e){return n.row-e.row})}function w(n){return N(n,function(n,e){return A(n,function(n){return n.column===e.column})?n:n.concat([e])},[]).sort(function(n,e){return n.column-e.column})}function t(n,e,t,r,o){var u=f(n,o,0,n.length,o,o,t,r);return a(u,e[0].row,e[0].column)}function r(n,e,t,r,o){var u=g(e),i=w(e),c=f(n,o,u[0].row,u[u.length-1].row,i[0].column,i[i.length-1].column,t,r);return a(c,e[0].row,e[0].column)}function o(n,e,t,r,o){var u=S(n,o,t,r);return a(u,e.row,e.column)}function u(n,e,t,r,o){var u=h(n,o,o,o,0,n[e[0].row].cells.length,t,r);return a(u,e[0].row,e[0].column)}function i(n,e,t,r,o){var u=g(e),i=w(e),c=h(n,o,u[0].row,u[u.length-1].row,i[0].column,i[i.length-1].column,t,r);return a(c,e[0].row,e[0].column)}function c(n,e,t,r,o){var u=x(n,o,t,r);return a(u,e.row,e.column)}function b(o,u,i,c,a){return function(n,e,t,r){return Or(function(n,e){return o(n,e,u,i,c)},a,C,C,Ot)(n,e,t,r)}}var n,y=(n=d.getParam("table_clone_elements"),M(n)?W.some(n.split(/[ ,]/)):Array.isArray(n)?W.some(n):W.none()),S=l,x=s;return{sortColumnRowsAsc:function(n){return e(b(t,_r,!0,n,Er),R,C,wo)},sortColumnRowsDesc:function(n){return e(b(t,_r,!1,n,Er),R,C,wo)},sortSelectionRowsAsc:function(n){return e(b(r,_r,!0,n,Er),R,C,wo)},sortSelectionRowsDesc:function(n){return e(b(r,_r,!1,n,Er),R,C,wo)},sortTableRowsAsc:function(n){return e(b(o,_r,!0,n,Dr),R,C,wo)},sortTableRowsDesc:function(n){return e(b(o,_r,!1,n,Dr),R,C,wo)},sortRowColumnsAsc:function(n){return e(b(u,_r,!0,n,Er),R,C,wo)},sortRowColumnsDesc:function(n){return e(b(u,_r,!1,n,Er),R,C,wo)},sortSelectionColumnsAsc:function(n){return e(b(i,_r,!0,n,Er),R,C,wo)},sortSelectionColumnsDesc:function(n){return e(b(i,_r,!1,n,Er),R,C,wo)},sortTableColumnsAsc:function(n){return e(b(c,_r,!0,n,Dr),R,C,wo)},sortTableColumnsDesc:function(n){return e(b(c,_r,!1,n,Dr),R,C,wo)}}}function yo(n){return at(n.get(),T([]),m,d)}function So(n){function e(n,e){return se(n,e).exists(function(n){return 1<parseInt(n,10)})}var t=yo(n);return 0<t.length&&b(t,function(n){return e(n,"rowspan")||e(n,"colspan")})?W.some(t):W.none()}function xo(n,e,t){return{element:t,mergable:(r=e,o=Wo,at(n.get(),W.none,function(e){return e.length<=1?W.none():ct(r,o.firstSelectedSelector,o.lastSelectedSelector).map(function(n){return{bounds:n,cells:e}})},W.none)),unmergable:So(n),selection:yo(n)};var r,o}function Co(u){return function(n){var e,t=Hn.fromDom(n.selection.getStart()),r=nn(t),o="col"===r||"colgroup"===r?Oe(e=t).bind(function(n){return it(n,Wo.firstSelectedSelector)}).fold(function(){return e},function(n){return n[0]}):t;return ie(o,u)}}function To(n,e){var t,r=(t=e,function(n){return U(n,qr(t))});return Oe(n,r)}function Ro(t){return function(n){var e=n.getData();n.close(),t.undoManager.transact(function(){t.execCommand("mceSortTableAdvanced",!1,e),t.focus(),t.addVisual()})}}function Ao(c,i){function t(n){var r,e;return{type:"selectbox",name:"roworcol",label:"column"===n?"Column":"Row",items:"column"===n?function(){var r=l.get().getOrDie("state must be present"),n=r.limit?r.finishCol+1-r.startCol:r.columns;return g(n,function(n){var e=r.limit?r.startCol:0,t=function(n){for(var e=n,t="";0<Math.floor(e);)--e,t+=String.fromCharCode("A".charCodeAt(0)+e%26),e/=26;return t.split("").reverse().join("")}(n+e+1);return{text:c.translate(["Column {0}",t]),value:""+(n+e)}})}():(r=l.get().getOrDie("state must be present"),e=r.limit?r.finishRow+1-r.startRow:r.rows,g(e,function(n){var e=r.limit?r.startRow:0,t=(n+e+1).toString();return{text:c.translate(["Row {0}",t]),value:""+(n+e)}}))}}function a(n){return{title:"Advanced Sort",size:"normal",body:{type:"panel",items:[{type:"grid",columns:2,items:[r,t(e=n),{type:"selectbox",name:"sort",label:"Sort",items:["column"===e?{text:"Column",value:"column"}:{text:"Row",value:"row"},{text:"Selection",value:"selection"},{text:"Table",value:"table"}]},o]}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"sort",text:"Sort",primary:!0}]};var e}function f(){l.set(W.none())}var r={type:"selectbox",name:"sortby",label:"Sort by",items:[{text:"Column",value:"column"},{text:"Row",value:"row"}]},l=vt(W.none()),o={type:"selectbox",name:"order",label:"Order",items:[{text:"Ascending",value:"ascending"},{text:"Descending",value:"descending"}]},s=function(n,e){if("sortby"===e.name){var t=n.getData(),r=l.get().getOrDie("state must be present"),o={roworcol:"column"===t.sortby?""+r.startCol:""+r.startRow},u=q(q({},t),o),i=q(q({},a(t.sortby)),{onChange:s,onClose:f,onSubmit:Ro(c),initialData:u});n.redial(i),n.focus("sortby")}};Mo(c).each(function(u){To(u,c).each(function(n){function t(n){l.set(W.some(n));var e={sortby:"column",roworcol:""+n.startCol,sort:"column",order:"ascending"},t=q(q({},a("column")),{onChange:s,onClose:f,onSubmit:Ro(c),initialData:e});c.windowManager.open(t)}var e,r=xo(i,n,u),o=(e=n,Ue.fromTable(e).grid);r.mergable.fold(function(){Ie(n,u,u).each(function(n){var e=q(q(q({},n),o),{limit:!1});t(e)})},function(n){var e=q(q(q({},n.bounds),o),{limit:!0});t(e)})})})}function Oo(t,r,o){function u(n){return function(){return t.execCommand(n)}}t.on("init",function(){var n=r().selectionTargets.onSetupCellOrRow,e=[{type:"menuitem",text:"Sort table by column ascending",onAction:u("mceSortTableByColumnAsc"),onSetup:n},{type:"menuitem",text:"Sort table by column descending",onAction:u("mceSortTableByColumnDesc"),onSetup:n},{type:"separator"},{type:"menuitem",text:"Advanced sort...",onAction:function(){return Ao(t,o)},onSetup:r().selectionTargets.onSetupCellOrRow}];t.ui.registry.addNestedMenuItem("advtablesort",{type:"nestedmenuitem",text:"Sort",getSubmenuItems:function(){return e}})})}function Do(n){var e,t,r,o,u;if(dt(tinymce,"5.1.2"))return console.error("Please use Advanced Tables with TinyMCE 5.1.2 or later."),{};if(o="table",u=n.getParam("plugins","","string"),l(u.split(/[ ,]/),o)){var i=function(){return n.plugins.table},c=bo(n,i),a=(e=function(){return qr(n)},t=function(){return Io(n)},r=Wo.selectedSelector,{get:function(){return it(e(),r).fold(function(){return t().map(Rt).getOrThunk(Ct)},function(n){return Tt(n)})}});Po(n,c,a),Oo(n,i,a)}else console.log("Please use the Advanced Tables Plugin together with the Tables plugin.");return{}}var Eo=function(o,u,e){function t(n){me(n,o.selected),me(n,o.firstSelected),me(n,o.lastSelected)}function i(n){ae(n,o.selected,"1")}function c(n){r(n),e()}var r=function(n){var e=gn(n,o.selectedSelector);D(e,t)};return{clearBeforeUpdate:r,clear:c,selectRange:function(n,e,t,r){c(n),D(e,i),ae(t,o.firstSelected,"1"),ae(r,o.lastSelected,"1"),u(e,t,r)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}},No="data-mce-selected",ko="data-mce-first-selected",jo="data-mce-last-selected",Wo={selected:No,selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:ko,firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:jo,lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Mo=Co("th,td"),Io=Co("th,td,caption"),Po=function(u,i,o){function c(n){return"selection"===n}function a(n){return"ascending"===n}function t(n){var e,t,r,o,u=parseInt(n.roworcol,10);"column"===n.sortby?(o=u,"column"===(r=n).sort?a(r.order)?s(i.sortColumnRowsAsc(o)):s(i.sortColumnRowsDesc(o)):c(r.sort)?a(r.order)?s(i.sortSelectionRowsAsc(o)):s(i.sortSelectionRowsDesc(o)):a(r.order)?s(i.sortTableRowsAsc(o)):s(i.sortTableRowsDesc(o))):(t=u,"row"===(e=n).sort?a(e.order)?s(i.sortRowColumnsAsc(t)):s(i.sortRowColumnsDesc(t)):c(e.sort)?a(e.order)?s(i.sortSelectionColumnsAsc(t)):s(i.sortSelectionColumnsDesc(t)):a(e.order)?s(i.sortTableColumnsAsc(t)):s(i.sortTableColumnsDesc(t)))}function f(o){return function(n){var e,t,r;u.selection.setRng(n.rng),u.focus(),l.clear(o),zr(o),e=u,t=o.dom,r=n.effect,e.fire("TableModified",q(q({},r),{table:t}))}}function n(){return Mo(u).bind(function(e){return To(e,u).bind(function(n){return Ie(n,e,e).map(function(n){return n.startCol})})})}function e(){return Mo(u).bind(function(e){return To(e,u).bind(function(n){return Ie(n,e,e).map(function(n){return n.startRow})})})}var l=Eo(Wo,C,C),s=function(r){Mo(u).each(function(t){To(t,u).each(function(n){var e=xo(o,n,t);r(n,e).each(f(n))})})};u.addCommand("mceSortTableByColumnAsc",function(){n().each(function(n){s(i.sortTableRowsAsc(n))})}),u.addCommand("mceSortTableByColumnDesc",function(){n().each(function(n){s(i.sortTableRowsDesc(n))})}),u.addCommand("mceSortTableByRowAsc",function(){e().each(function(n){s(i.sortTableColumnsAsc(n))})}),u.addCommand("mceSortTableByRowDesc",function(){e().each(function(n){s(i.sortTableColumnsDesc(n))})}),u.addCommand("mceSortTableAdvanced",function(n,e){return t(e)}),u.addCommand("mceAdvancedTableSort",function(){return Ao(u,o)})};tinymce.PluginManager.add("advtable",Do)}();