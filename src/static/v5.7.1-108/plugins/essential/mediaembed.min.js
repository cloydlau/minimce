/*!
 * Tiny Media Embed plugin
 *
 * Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.
 *
 * Version: 2.2.5-103
 */
!function(f){"use strict";var n,e,r,t,o,i,u,c,a,s=function(n){return parseInt(n,10)},l=function(n,e){var r=n-e;return 0===r?0:0<r?1:-1},d=function(n,e,r){return{major:n,minor:e,patch:r}},m=function(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?d(s(e[1]),s(e[2]),s(e[3])):d(0,0,0)},p=function(n,e){return!!n&&-1===function(n,e){var r=l(n.major,e.major);if(0!==r)return r;var t=l(n.minor,e.minor);if(0!==t)return t;var o=l(n.patch,e.patch);return 0!==o?o:0}(m([(r=n).majorVersion,r.minorVersion].join(".").split(".").slice(0,3).join(".")),m(e));var r},h=function(){},v=function(r,t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r(t.apply(null,n))}},y=function(n){return function(){return n}},g=function(n){return n},w=y(!1),b=y(!0),T=function(){return x},x=(n=function(n){return n.isNone()},t={fold:function(n,e){return n()},is:w,isSome:w,isNone:b,getOr:r=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:y(null),getOrUndefined:y(void 0),or:r,orThunk:e,map:T,each:h,bind:T,exists:w,forall:b,filter:T,equals:n,equals_:n,toArray:function(){return[]},toString:y("none()")},Object.freeze&&Object.freeze(t),t),S=function(r){var n=y(r),e=function(){return o},t=function(n){return n(r)},o={fold:function(n,e){return e(r)},is:function(n){return r===n},isSome:b,isNone:w,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return S(n(r))},each:function(n){n(r)},bind:t,exists:t,forall:t,filter:function(n){return n(r)?o:x},toArray:function(){return[r]},toString:function(){return"some("+r+")"},equals:function(n){return n.is(r)},equals_:function(n,e){return n.fold(w,function(n){return e(r,n)})}};return o},E={some:S,none:T,from:function(n){return null==n?x:S(n)}},O=function(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}},_=O("string"),N=O("object"),C=O("array"),D=O("boolean"),k=O("function"),A=O("number"),R=Array.prototype.slice,I=Array.prototype.indexOf,j=Array.prototype.push,F=function(n,e){return r=n,t=e,-1<I.call(r,t);var r,t},P=function(n,e){for(var r=n.length,t=new Array(r),o=0;o<r;o++){var i=n[o];t[o]=e(i,o)}return t},M=function(n,e){for(var r=0,t=n.length;r<t;r++){e(n[r],r)}},L=function(n,e){for(var r=[],t=0,o=n.length;t<o;t++){var i=n[t];e(i,t)&&r.push(i)}return r},U=function(n,e){for(var r=0,t=n.length;r<t;r++){var o=n[r];if(e(o,r))return E.some(o)}return E.none()},B=function(n){for(var e=[],r=0,t=n.length;r<t;++r){if(!C(n[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+n);j.apply(e,n[r])}return e},V=function(n,e){return B(P(n,e))},W=k(Array.from)?Array.from:function(n){return R.call(n)},q=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(e.length!==r.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+r.length+" arguments");var t={};return M(e,function(n,e){t[n]=y(r[e])}),t}},H=Object.keys,J=Object.hasOwnProperty,K=function(n,e){for(var r=H(n),t=0,o=r.length;t<o;t++){var i=r[t];e(n[i],i)}},z=function(n,t){var o={};return K(n,function(n,e){var r=t(n,e);o[r.k]=r.v}),o},$=function(n,e){return X(n,e)?E.from(n[e]):E.none()},X=function(n,e){return J.call(n,e)},Y=function(n,e,r){return 0!=(n.compareDocumentPosition(e)&r)},G=function(n,e){return Y(n,e,f.Node.DOCUMENT_POSITION_CONTAINED_BY)},Q=function(){return(Q=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},Z=function(n){var e=n,r=function(){return e};return{get:r,set:function(n){e=n},clone:function(){return Z(r())}}},nn=function(){return en(0,0)},en=function(n,e){return{major:n,minor:e}},rn={nu:en,detect:function(n,e){var r=String(e).toLowerCase();return 0===n.length?nn():function(n,e){var r=function(n,e){for(var r=0;r<n.length;r++){var t=n[r];if(t.test(e))return t}}(n,e);if(!r)return{major:0,minor:0};var t=function(n){return Number(e.replace(r,"$"+n))};return en(t(1),t(2))}(n,r)},unknown:nn},tn="Firefox",on=function(n,e){return function(){return e===n}},un=function(n){var e=n.current;return{current:e,version:n.version,isEdge:on("Edge",e),isChrome:on("Chrome",e),isIE:on("IE",e),isOpera:on("Opera",e),isFirefox:on(tn,e),isSafari:on("Safari",e)}},cn={unknown:function(){return un({current:void 0,version:rn.unknown()})},nu:un,edge:y("Edge"),chrome:y("Chrome"),ie:y("IE"),opera:y("Opera"),firefox:y(tn),safari:y("Safari")},an="Windows",fn="Android",sn="Solaris",ln="FreeBSD",dn="ChromeOS",mn=function(n,e){return function(){return e===n}},pn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:mn(an,e),isiOS:mn("iOS",e),isAndroid:mn(fn,e),isOSX:mn("OSX",e),isLinux:mn("Linux",e),isSolaris:mn(sn,e),isFreeBSD:mn(ln,e),isChromeOS:mn(dn,e)}},hn={unknown:function(){return pn({current:void 0,version:rn.unknown()})},nu:pn,windows:y(an),ios:y("iOS"),android:y(fn),linux:y("Linux"),osx:y("OSX"),solaris:y(sn),freebsd:y(ln),chromeos:y(dn)},vn=function(n,e){var r=String(e).toLowerCase();return U(n,function(n){return n.search(r)})},gn=function(n,r){return vn(n,r).map(function(n){var e=rn.detect(n.versionRegexes,r);return{current:n.name,version:e}})},yn=function(n,r){return vn(n,r).map(function(n){var e=rn.detect(n.versionRegexes,r);return{current:n.name,version:e}})},wn=function(n,e){return-1!==n.indexOf(e)},bn=function(n,e){return r=n,o=0,""===(t=e)||!(r.length<t.length)&&r.substr(o,o+t.length)===t;var r,t,o},Tn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,xn=function(e){return function(n){return wn(n,e)}},Sn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return wn(n,"edge/")&&wn(n,"chrome")&&wn(n,"safari")&&wn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Tn],search:function(n){return wn(n,"chrome")&&!wn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return wn(n,"msie")||wn(n,"trident")}},{name:"Opera",versionRegexes:[Tn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:xn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:xn("firefox")},{name:"Safari",versionRegexes:[Tn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(wn(n,"safari")||wn(n,"mobile/"))&&wn(n,"applewebkit")}}],En=[{name:"Windows",search:xn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return wn(n,"iphone")||wn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:xn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:xn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:xn("linux"),versionRegexes:[]},{name:"Solaris",search:xn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:xn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:xn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],On={browsers:y(Sn),oses:y(En)},_n=Z(function(n,e){var r,t,o,i,u,c,a,f,s,l,d,m,p=On.browsers(),h=On.oses(),v=gn(p,n).fold(cn.unknown,cn.nu),g=yn(h,n).fold(hn.unknown,hn.nu);return{browser:v,os:g,deviceType:(t=v,o=n,i=e,u=(r=g).isiOS()&&!0===/ipad/i.test(o),c=r.isiOS()&&!u,a=r.isiOS()||r.isAndroid(),f=a||i("(pointer:coarse)"),s=u||!c&&a&&i("(min-device-width:768px)"),l=c||a&&!s,d=t.isSafari()&&r.isiOS()&&!1===/safari/i.test(o),m=!l&&!s&&!d,{isiPad:y(u),isiPhone:y(c),isTablet:y(s),isPhone:y(l),isTouch:y(f),isAndroid:r.isAndroid,isiOS:r.isiOS,isWebView:y(d),isDesktop:y(m)})}}(f.navigator.userAgent,function(n){return f.window.matchMedia(n).matches})),Nn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:y(n)}},Cn={fromHtml:function(n,e){var r=(e||f.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||1<r.childNodes.length)throw f.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Nn(r.childNodes[0])},fromTag:function(n,e){var r=(e||f.document).createElement(n);return Nn(r)},fromText:function(n,e){var r=(e||f.document).createTextNode(n);return Nn(r)},fromDom:Nn,fromPoint:function(n,e,r){var t=n.dom();return E.from(t.elementFromPoint(e,r)).map(Nn)}},Dn=(f.Node.ATTRIBUTE_NODE,f.Node.CDATA_SECTION_NODE,f.Node.COMMENT_NODE,f.Node.DOCUMENT_NODE),kn=(f.Node.DOCUMENT_TYPE_NODE,f.Node.DOCUMENT_FRAGMENT_NODE,f.Node.ELEMENT_NODE),An=(f.Node.TEXT_NODE,f.Node.PROCESSING_INSTRUCTION_NODE,f.Node.ENTITY_REFERENCE_NODE,f.Node.ENTITY_NODE,f.Node.NOTATION_NODE,kn),Rn=Dn,In=function(n){return n.nodeType!==An&&n.nodeType!==Rn||0===n.childElementCount},jn=(_n.get().browser.isIE(),void 0!==f.window?f.window:Function("return this;")(),function(n){return n.dom().nodeName.toLowerCase()}),Fn=function(n,e){for(var r=[],t=function(n){return r.push(n),e(n)},o=e(n);(o=o.bind(t)).isSome(););return r},Pn=function(n){return E.from(n.dom().parentNode).map(Cn.fromDom)},Mn=function(n){return E.from(n.dom().previousSibling).map(Cn.fromDom)},Ln=function(n){return E.from(n.dom().nextSibling).map(Cn.fromDom)},Un=function(n){return e=Fn(n,Mn),(r=R.call(e,0)).reverse(),r;var e,r},Bn=function(n){return P(n.dom().childNodes,Cn.fromDom)},Vn=function(n){return e=0,r=n.dom().childNodes,E.from(r[e]).map(Cn.fromDom);var e,r},Wn=(q("element","offset"),function(n,e){return r=function(n){return function(n,e){var r=n.dom();if(r.nodeType!==An)return!1;var t=r;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}(n,e)},L(Bn(n),r);var r}),qn=function(n,e){return r=e,o=void 0===(t=n)?f.document:t.dom(),In(o)?[]:P(o.querySelectorAll(r),Cn.fromDom);var r,t,o},Hn=function(n){return n.dom().textContent},Jn={isBlock:(o=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],function(n){return(i=i||function(n,e){for(var r={},t=0,o=n.length;t<o;t++){var i=n[t];r[String(i)]=e(i,t)}return r}(o,y(!0))).hasOwnProperty(jn(n))})},Kn=function(e,r){return function(n){return e(n)||r(n)}},zn=q("start","end","caret"),$n=function(n){return"br"===jn(n)},Xn=function(e){return n=Pn(e.start()),r=Pn(e.end()),t=function(){var n=f.document.createRange();return n.setStartBefore(e.start().dom()),n.setEndAfter(e.end().dom()),n},n.isSome()&&r.isSome()?E.some(t(n.getOrDie(),r.getOrDie())):E.none();var n,r,t},Yn=function(n,e){var r=e[e.length-1];return function(n,e){for(var r=0,t=n.length;r<t;r++)if(e(n[r],r))return E.some(r);return E.none()}(n,function(n){return e=r,n.dom()===e.dom();var e}).getOrDie("how is it possible you can't find a br you just found?")},Gn=function(n){return L(Wn(n,"br"),function(n){return Ln(n).isSome()})},Qn=function(n){return e=function(n,e){return n+Hn(e)},r="",M(n,function(n){r=e(r,n)}),r;var e,r},Zn=Gn,ne=Yn,ee=function(n){if(!1===n.collapsed)return E.none();var e,r,t,o,i,u,c,a=(r=(e=n).startContainer,t=e.startOffset,void 0===r?E.none():3===r.nodeType?0===t?E.some(r).map(Cn.fromDom):E.none():E.from(r.childNodes[t]).map(Cn.fromDom)),f=a.bind(Mn).filter($n),s=f.map(Un).bind(function(n){return U(n.reverse(),Kn($n,Jn.isBlock)).fold(function(){return E.from(n[n.length-1])},Ln)});return i=f,u=a,c=zn,(o=s).isSome()&&i.isSome()&&u.isSome()?E.some(c(o.getOrDie(),i.getOrDie(),u.getOrDie())):E.none()},re=Xn,te=function(n){return Xn(n).fold(y(""),function(n){return n.toString()})},oe=Qn,ie=function(n){var e=Gn(n);if(0<e.length){var r=Bn(n),t=Yn(r,e),o=r.slice(t+1);return Qn(o)}return Hn(n)},ue=function(n){return _(n.mediaembed_service_url)},ce=function(n){return A(n.mediaembed_max_width)?n.mediaembed_max_width:650},ae=function(n){var e=n.api_key;return e||n.mediaembed_api_key},fe=function(n,e){return _(n.mediaembed_content_css)?n.mediaembed_content_css:e},se=function(n){return n.getParam("mediaembed_inline_styles",!1,"boolean")},le=function(n,e,r){!function(n,e,r){if(!(_(r)||D(r)||A(r)))throw f.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")}(n.dom(),e,r)},de=function(n,t){Ln(n).fold(function(){Pn(n).each(function(n){me(n,t)})},function(n){var e,r;r=t,Pn(e=n).each(function(n){n.dom().insertBefore(r.dom(),e.dom())})})},me=function(n,e){n.dom().appendChild(e.dom())},pe=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},he=function(n){return e=n,r=!0,Cn.fromDom(e.dom().cloneNode(r));var e,r},ve=function(n){return void 0!==n.style&&k(n.style.getPropertyValue)},ge=function(n,e,r){if(!_(r))throw f.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);ve(n)&&n.style.setProperty(e,r)},ye=function(n,e,r){var t=n.dom();ge(t,e,r)},we=function(n,e){var r,t,o=n.dom(),i=(t=e,ve(r=o)?r.style.getPropertyValue(t):"");return E.from(i).filter(function(n){return 0<n.length})},be=function(n){var e=Cn.fromTag("div"),r=Cn.fromDom(n.dom().cloneNode(!0));return me(e,r),e.dom().innerHTML},Te=function(n){var e=n.dom().styleSheets;return Array.prototype.slice.call(e)},xe={},Se={exports:xe};c=xe,a=Se,u=void 0,function(n){"object"==typeof c&&void 0!==a?a.exports=n():"function"==typeof u&&u.amd?u([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function i(u,c,a){function f(e,n){if(!c[e]){if(!u[e]){var r=!1;if(!n&&r)return r(e,!0);if(s)return s(e,!0);var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}var o=c[e]={exports:{}};u[e][0].call(o.exports,function(n){return f(u[e][1][n]||n)},o,o.exports,i,u,c,a)}return c[e].exports}for(var s=!1,n=0;n<a.length;n++)f(a[n]);return f}({1:[function(n,e,r){var t,u,o=(t=function(n){var e,r,t,o,i=[];for(t=0,o=(e=n.split(",")).length;t<o;t+=1)0<(r=e[t]).length&&i.push(u(r));return i},u=function(a){var n,e,r,f=a,s={a:0,b:0,c:0},l=[];return n=function(n,e){var r,t,o,i,u,c;if(n.test(f))for(t=0,o=(r=f.match(n)).length;t<o;t+=1)s[e]+=1,i=r[t],u=f.indexOf(i),c=i.length,l.push({selector:a.substr(u,c),type:e,index:u,length:c}),f=f.replace(i,Array(c+1).join(" "))},(e=function(n){var e,r,t,o;if(n.test(f))for(r=0,t=(e=f.match(n)).length;r<t;r+=1)o=e[r],f=f.replace(o,Array(o.length+1).join("A"))})(/\\[0-9A-Fa-f]{6}\s?/g),e(/\\[0-9A-Fa-f]{1,5}\s/g),e(/\\./g),(r=/:not\(([^\)]*)\)/g).test(f)&&(f=f.replace(r,"     $1 ")),function(){var n,e,r,t,o=/{[^]*/gm;if(o.test(f))for(e=0,r=(n=f.match(o)).length;e<r;e+=1)t=n[e],f=f.replace(t,Array(t.length+1).join(" "))}(),n(/(\[[^\]]+\])/g,"b"),n(/(#[^\#\s\+>~\.\[:]+)/g,"a"),n(/(\.[^\s\+>~\.\[:]+)/g,"b"),n(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,"c"),n(/(:[\w-]+\([^\)]*\))/gi,"b"),n(/(:[^\s\+>~\.\[:]+)/g,"b"),f=(f=f.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),n(/([^\s\+>~\.\[:]+)/g,"c"),l.sort(function(n,e){return n.index-e.index}),{selector:a,specificity:"0,"+s.a.toString()+","+s.b.toString()+","+s.c.toString(),specificityArray:[0,s.a,s.b,s.c],parts:l}},{calculate:t,compare:function(n,e){var r,t,o;if("string"==typeof n){if(-1!==n.indexOf(","))throw"Invalid CSS selector";r=u(n).specificityArray}else{if(!Array.isArray(n))throw"Invalid CSS selector or specificity array";if(4!==n.filter(function(n){return"number"==typeof n}).length)throw"Invalid specificity array";r=n}if("string"==typeof e){if(-1!==e.indexOf(","))throw"Invalid CSS selector";t=u(e).specificityArray}else{if(!Array.isArray(e))throw"Invalid CSS selector or specificity array";if(4!==e.filter(function(n){return"number"==typeof n}).length)throw"Invalid specificity array";t=e}for(o=0;o<4;o+=1){if(r[o]<t[o])return-1;if(r[o]>t[o])return 1}return 0}});void 0!==r&&(r.calculate=o.calculate,r.compare=o.compare)},{}],2:[function(n,e,r){var t=n("specificity");e.exports={boltExport:t}},{specificity:1}]},{},[2])(2)});var Ee,Oe,_e=Se.exports.boltExport,Ne=function(n){var e=n.cssRules;return V(e,function(n){return n.type===f.CSSRule.IMPORT_RULE?Ne(n.styleSheet):n.type===f.CSSRule.STYLE_RULE?[function(n){var e=n.selectorText,r=n.style.cssText;if(void 0===r)throw new Error("WARNING: Browser does not support cssText property");return{selector:e,style:r,raw:n.style}}(n)]:[]})},Ce=function(n){return V(n,Ne)},De=function(e,n,r){var t=V(n,function(c){var n=qn(e,c.selector);return M(n,function(n){var r,t,o,e,i,u=(r=c.raw,t=n,o={},M(r,function(n){if(void 0!==r[n]){var e=t.dom().style;F(e,n)||(o[n]=r[n])}}),o);e=u,i=n.dom(),K(e,function(n,e){ge(i,e,n)})}),n});r&&M(t,function(n){var e;e="class",n.dom().removeAttribute(e)})},ke=function(n,e,r){var t=function(n){return-1!==n.selector.indexOf(",")},o=V(L(n,t),function(e){var n=e.selector.split(",");return P(n,function(n){return{selector:n.trim(),raw:e.raw}})}),i=L(n,function(n){return!t(n)}).concat(o);i.sort(function(n,e){return _e.compare(n.selector,e.selector)}).reverse(),De(e,i,r)},Ae=function(n,e,r,t){var o=Te(n),i=Ce(o).map(function(n){var e=n.selector;return{selector:r.hasOwnProperty(e)?r[e]:e,raw:n.raw}});ke(i,e,t)},Re=function(n,e,r,t){var o=Te(n),i=Ce(o),u=L(i,function(n){return bn(n.selector,r)});ke(u,e,t)},Ie=function(n,e,r,t){var o=Te(n),i=Ce(o),u=L(i,function(n){return F(r,n.selector)});ke(u,e,t)},je={inlineStyles:function(n,e,r){Ae(n,e,r,!0)},inlineStylesKeepClasses:function(n,e,r){Ae(n,e,r,!1)},inlinePrefixedStyles:function(n,e,r){Re(n,e,r,!0)},inlinePrefixedStylesKeepClasses:function(n,e,r){Re(n,e,r,!1)},inlineSelectorsStyles:function(n,e,r){Ie(n,e,r,!0)},inlineSelectorsStylesKeepClasses:function(n,e,r){Ie(n,e,r,!1)}},Fe={inlineStyles:je.inlineStyles,inlineStylesKeepClasses:je.inlineStylesKeepClasses,inlinePrefixedStyles:je.inlinePrefixedStyles,inlinePrefixedStylesKeepClasses:je.inlinePrefixedStylesKeepClasses,inlineSelectorsStyles:je.inlineSelectorsStyles,inlineSelectorsStylesKeepClasses:je.inlineSelectorsStylesKeepClasses},Pe=function(n){return 1===n.dom().nodeType?n:Ln(n).fold(function(){return n},Pe)},Me=function(n,e){var r=n.parser.parse(e,{isRootContent:!0,forced_root_block:!1}),t=new tinymce.html.Serializer({validate:!0},n.schema).serialize(r),o=Cn.fromDom(n.dom.createFragment(t));return Be(n,o)},Le=function(n,e){return jn(e).toLowerCase()===n.toLowerCase()},Ue=function(n,e){var r=n.dom.createFragment(e);return Pe(Cn.fromDom(r.firstChild))},Be=function(n,e){if(se(n)){var r=Cn.fromTag("div");me(r,e);var t=n.getDoc(),o=Cn.fromDom(t);Fe.inlinePrefixedStyles(o,r,".ephox-summary-card");var i=qn(r,"*[style]");return M(i,function(n){var e,r,t=(e="style",null===(r=n.dom().getAttribute(e))?void 0:r);le(n,"data-mce-style",t)}),u=Bn(r),a=(c||f.document).createDocumentFragment(),M(u,function(n){a.appendChild(n.dom())}),Cn.fromDom(a)}return e;var u,c,a},Ve=function(n,e,r){var t=Me(n,be(r));n.undoManager.transact(function(){var n;(n=e).dom().textContent="",M(Bn(n),function(n){pe(n)}),me(e,t)})},We=function(n,e,r){var t=he(r);return we(t,"max-width").isNone()&&ye(t,"max-width",e+"px"),le(t,"data-ephox-embed-iri",n),le(t,"contentEditable",!1),t},qe=function(n,e,r){return Le("DIV",e)?We(n,r,e):We(n,r,((Le("VIDEO",i=e)||Le("AUDIO",i))&&ye(i,"width","100%"),t=i,o=Cn.fromTag("div"),me(o,he(t)),o));var t,o,i},He=function(n,e,r){return Le("A",e)?e:qe(n,e,r)},Je=function(n,e,r,t,o){var i,u,c,a,f,s,l,d,m=Bn(e),p=ne(m,r),h=m.slice(p),v=m.slice(p+1);if(oe(v)===t){var g=He(t,Ue(n,o),ce(n.settings));Le("DIV",g)?(s=e,l=h,d=Me(f=n,be(g)),Vn(d).each(function(n){f.undoManager.transact(function(){de(s,n),M(l,pe)})})):(u=e,c=v,a=Me(i=n,be(g)),i.undoManager.transact(function(){M(c,pe),me(u,a)}))}},Ke=function(n,e,r,t){var o,i,u,c=He(r,Ue(n,t),ce(n.settings));Le("DIV",c)?(i=e,u=Me(o=n,be(c)),Vn(u).each(function(n){o.undoManager.transact(function(){de(i,n),pe(i)})})):Ve(n,e,c)},ze=function(r,n,t,o){n.filter(function(n){return Pn(n).isSome()}).each(function(n){var e=Zn(n);0<e.length?Je(r,n,e,t,o):Ke(r,n,t,o)})},$e=function(n,e,r){var t=Ue(n,r);return be(He(e,t,ce(n.settings)))},Xe=function(u,n,e,r){n.map(function(i){re(i).each(function(t){var n=He(e,Ue(u,r),ce(u.settings)),o=Me(u,be(n));u.undoManager.transact(function(){var n,e,r;t.deleteContents(),t.insertNode(o.dom()),t.collapse(!1),n=u,e=i.caret().dom(),r=n.dom.createRng(),3===e.nodeType?(r.setStart(e,0),r.setEnd(e,0)):(r.setStartBefore(e),r.setEndAfter(e)),n.selection.setRng(r)})})})},Ye=function(n){var e,r,t=(e=n.split(" "),r={},M(e,function(n){r[n.toLowerCase()]=!0}),r);return function(n){return!!n&&n.nodeName.toLowerCase()in t}},Ge=Ye("h1 h2 h3 h4 h5 h6 p span"),Qe=Ye("strong em b span a br"),Ze=function(n){return U((e=n,e?W(e.querySelectorAll("*")):[]),(r=Qe,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!r.apply(null,n)})).isNone();var r,e},nr=function(n){return Ge(n.dom())&&Ze(n.dom())},er=function(n){return/^https?:\/\/\S+$/i.test(n.trim())},rr=function(n){return E.from(n).filter(nr).map(ie).filter(er)},tr=function(c,a,f){c.on("newBlock",function(n){var e,t,o,i,u;e=n,t=c,o=a,i=f,(u=Mn(Cn.fromDom(e.newBlock))).bind(rr).map(function(r){o.getAndHandleResponse(r,function(n){var e=n.recommended().html();ze(t,u,r,e)},i.logError)})}),c.settings.forced_root_block||c.on("keydown",function(n){var t,e,o,r,i;13===n.keyCode&&(e=a,o=f,r=(t=c).selection.getRng(),(i=ee(r)).map(te).filter(er).map(function(r){e.getAndHandleResponse(r,function(n){var e=n.recommended().html();Xe(t,i,r,e)},o.logError)}))})},or=function(n){M(n,function(n){var e;(e=new tinymce.html.Node("span",1)).attr("class","mce-shim"),e.attr("data-mce-bogus","1"),n.append(e),n.attr("contenteditable","false")})},ir=function(n){M(n,function(n){n.attr("contenteditable",null)})},ur=function(e){e.on("click keyup touchend",function(){var n=e.selection.getNode();n&&e.dom.getAttrib(n,"data-ephox-embed-iri")&&e.dom.getAttrib(n,"data-mce-selected")&&n.setAttribute("data-mce-selected","2")}),tinymce.Env.ceFalse&&e.on("PreInit",function(){e.parser.addAttributeFilter("data-ephox-embed-iri",or),e.serializer.addAttributeFilter("data-ephox-embed-iri",ir)})},cr=function(n,e,r){var o,i,u;"media_url_resolver"in n.settings==0&&(n.settings.media_url_resolver=(o=n,i=e,u=r,function(r,t,e){!1!==er(r.url)?i.getAndHandleResponse(r.url,function(n){var e=n.recommended().html();t({html:$e(o,r.url,e)})},function(n){u.logDialogError(n),e({msg:u.formatMessage(n.msg(),n.code())})}):t({html:""})}))},ar=function(t,o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.console;r&&o in r&&r[o].apply(r,arguments)}},fr={log:ar(window,"log"),error:ar(window,"error"),warn:ar(window,"warm")},sr=[{code:404,message:"The specified url was not found."},{code:600,message:"The specified service did not respond correctly."},{code:601,message:"The specified service did not respond correctly."}],lr=function(n,e){return U(sr,function(n){return n.code===e}).fold(function(){return"Server didn't produce a valid result. ("+e+")"},function(n){return n.message})},dr=function(t){var r,o=function(n){var e,r=function(n){if("string"==typeof n)return{message:n};var e=n.code();return{message:lr(n.msg(),e),code:e}}(n);e=r,t.fire("MediaEmbedError",e),fr.error("Media embed error: "+r.message)};return{formatMessage:lr,logDialogError:function(n){var e=n.msg();e!==r&&o(n),r=e},logError:o}},mr=function(r){return{is:function(n){return r===n},isValue:b,isError:w,getOr:y(r),getOrThunk:y(r),getOrDie:y(r),or:function(n){return mr(r)},orThunk:function(n){return mr(r)},fold:function(n,e){return e(r)},map:function(n){return mr(n(r))},mapError:function(n){return mr(r)},each:function(n){n(r)},bind:function(n){return n(r)},exists:function(n){return n(r)},forall:function(n){return n(r)},toOption:function(){return E.some(r)}}},pr=function(r){return{is:w,isValue:w,isError:b,getOr:g,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(r),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(r)},map:function(n){return pr(r)},mapError:function(n){return pr(n(r))},each:h,bind:function(n){return pr(r)},exists:w,forall:b,toOption:E.none}},hr={value:mr,error:pr,fromOption:function(n,e){return n.fold(function(){return pr(e)},mr)}};(Oe=Ee||(Ee={}))[Oe.Error=0]="Error",Oe[Oe.Value=1]="Value";var vr,gr,yr,wr=function(n,e,r){return n.stype===Ee.Error?e(n.serror):r(n.svalue)},br=function(n){return{stype:Ee.Value,svalue:n}},Tr=function(n){return{stype:Ee.Error,serror:n}},xr=function(n){return wr(n,hr.error,hr.value)},Sr=br,Er=function(n){var e=[],r=[];return M(n,function(n){wr(n,function(n){return r.push(n)},function(n){return e.push(n)})}),{values:e,errors:r}},Or=Tr,_r=function(n,e){return n.stype===Ee.Value?e(n.svalue):n},Nr=function(n,e){return n.stype===Ee.Error?e(n.serror):n},Cr=function(n,e){return n.stype===Ee.Value?{stype:Ee.Value,svalue:e(n.svalue)}:n},Dr=function(n,e){return n.stype===Ee.Error?{stype:Ee.Error,serror:e(n.serror)}:n},kr=function(n){return N(n)&&100<H(n).length?" removed due to size":JSON.stringify(n,null,2)},Ar=function(n,e){return Or([{path:n,getErrorInfo:e}])},Rr=function(u){if(!C(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],r={};return M(u,function(n,t){var e=H(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],i=n[o];if(void 0!==r[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!C(i))throw new Error("case arguments must be an array");c.push(o),r[o]=function(){var n=arguments.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+i.length+" ("+i+"), got "+n);for(var r=new Array(n),e=0;e<r.length;e++)r[e]=arguments[e];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[t].apply(null,r)},match:function(n){var e=H(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!function(n,e){for(var r=0,t=n.length;r<t;++r)if(!0!==e(n[r],r))return!1;return!0}(c,function(n){return F(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,r)},log:function(n){f.console.log(n,{constructors:c,constructor:o,params:r})}}}}),r},Ir=Object.prototype.hasOwnProperty,jr=function(u){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},t=0;t<n.length;t++){var o=n[t];for(var i in o)Ir.call(o,i)&&(r[i]=u(r[i],o[i]))}return r}},Fr=jr(function(n,e){return N(n)&&N(e)?Fr(n,e):e}),Pr=jr(function(n,e){return e}),Mr=Rr([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Lr=Mr.strict,Ur=(Mr.asOption,Mr.defaultedThunk,Mr.asDefaultedOptionThunk,Mr.mergeWithThunk,function(n,e){var r;return(r={})[n]=e,r}),Br=(Rr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){return v(Or,B)(n)}),Vr=function(n,e){var r,t,o=Er(n);return 0<o.errors.length?Br(o.errors):(r=o.values,t=e,0<r.length?Sr(Fr(t,Pr.apply(void 0,r))):Sr(t))},Wr=function(n){var e=Er(n);return 0<e.errors.length?Br(e.errors):Sr(e.values)},qr=Rr([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Hr=function(r,t,o){return $(t,o).fold(function(){return n=o,e=t,Ar(r,function(){return'Could not find valid *strict* value for "'+n+'" in '+kr(e)});var n,e},Sr)},Jr=function(n,e,r){var t=$(n,e).fold(function(){return r(n)},g);return Sr(t)},Kr=function(c,a,n,f){return n.fold(function(o,r,n,t){var i=function(n){var e=t.extract(c.concat([o]),f,n);return Cr(e,function(n){return Ur(r,f(n))})},u=function(n){return n.fold(function(){var n=Ur(r,f(E.none()));return Sr(n)},function(n){var e=t.extract(c.concat([o]),f,n);return Cr(e,function(n){return Ur(r,f(E.some(n)))})})};return n.fold(function(){return _r(Hr(c,a,o),i)},function(n){return _r(Jr(a,o,n),i)},function(){return _r(Sr($(a,o)),u)},function(n){return _r((r=n,t=$(e=a,o).map(function(n){return!0===n?r(e):n}),Sr(t)),u);var e,r,t},function(n){var e=n(a),r=Cr(Jr(a,o,y({})),function(n){return Fr(e,n)});return _r(r,i)})},function(n,e){var r=e(a);return Sr(Ur(n,f(r)))})},zr=function(t){return{extract:function(r,n,e){return Nr(t(e,n),function(n){return e=n,Ar(r,function(){return e});var e})},toString:function(){return"val"}}},$r=function(c){return{extract:function(n,e,r){return t=n,o=r,i=e,u=P(c,function(n){return Kr(t,o,n,i)}),Vr(u,{});var t,o,i,u},toString:function(){return"obj{\n"+P(c,function(n){return n.fold(function(n,e,r,t){return n+" -> "+t.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},Xr=y(zr(Sr)),Yr=v(function(o){return{extract:function(r,t,n){var e=P(n,function(n,e){return o.extract(r.concat(["["+e+"]"]),t,n)});return Wr(e)},toString:function(){return"array("+o.toString()+")"}}},$r),Gr=(qr.state,qr.field),Qr=function(n,e,r,t){var o=e.extract([n],r,t);return Dr(o,function(n){return{input:t,errors:n}})},Zr=function(n,e,r){return xr(Qr(n,e,y,r))},nt=function(n,e,r){return xr(Qr(n,e,g,r)).fold(function(n){throw new Error(et(n))},g)},et=function(n){return"Errors: \n"+(e=n.errors,r=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,P(r,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})).join("\n")+"\n\nInput object: "+kr(n.input);var e,r},rt={},tt={exports:rt};gr=rt,yr=tt,vr=void 0,function(n){"object"==typeof gr&&void 0!==yr?yr.exports=n():"function"==typeof vr&&vr.amd?vr([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function i(u,c,a){function f(e,n){if(!c[e]){if(!u[e]){var r=!1;if(!n&&r)return r(e,!0);if(s)return s(e,!0);var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}var o=c[e]={exports:{}};u[e][0].call(o.exports,function(n){return f(u[e][1][n]||n)},o,o.exports,i,u,c,a)}return c[e].exports}for(var s=!1,n=0;n<a.length;n++)f(a[n]);return f}({1:[function(n,e,r){var t,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===u||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:u}catch(n){t=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,d=-1;function m(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&p())}function p(){if(!l){var n=a(m);l=!0;for(var e=s.length;e;){for(f=s,s=[];++d<e;)f&&f[d].run();d=-1,e=s.length}f=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(n){try{return o.call(null,e)}catch(n){return o.call(this,e)}}}(n)}}function h(n,e){this.fun=n,this.array=e}function v(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];s.push(new h(n,e)),1!==s.length||l||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,l,e){(function(r){!function(n){var e=setTimeout;function t(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function o(r,t){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,i._immediateFn(function(){var n=1===r._state?t.onFulfilled:t.onRejected;if(null!==n){var e;try{e=n(r._value)}catch(n){return void c(t.promise,n)}u(t.promise,e)}else(1===r._state?u:c)(t.promise,r._value)})):r._deferreds.push(t)}function u(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var r=n.then;if(n instanceof i)return e._state=3,e._value=n,void a(e);if("function"==typeof r)return void s((t=r,o=n,function(){t.apply(o,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var t,o}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,r=n._deferreds.length;e<r;e++)o(n,n._deferreds[e]);n._deferreds=null}function f(n,e,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=r}function s(n,e){var r=!1;try{n(function(n){r||(r=!0,u(e,n))},function(n){r||(r=!0,c(e,n))})}catch(n){if(r)return;r=!0,c(e,n)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var r=new this.constructor(t);return o(this,new f(n,e,r)),r},i.all=function(n){var c=Array.prototype.slice.call(n);return new i(function(t,o){if(0===c.length)return t([]);var i=c.length;function u(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var r=n.then;if("function"==typeof r)return void r.call(n,function(n){u(e,n)},o)}c[e]=n,0==--i&&t(c)}catch(n){o(n)}}for(var n=0;n<c.length;n++)u(n,c[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(r){return new i(function(n,e){e(r)})},i.race=function(o){return new i(function(n,e){for(var r=0,t=o.length;r<t;r++)o[r].then(n,e)})},i._immediateFn="function"==typeof r?function(n){r(n)}:function(n){e(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,f){(function(n,e){var t=a("process/browser.js").nextTick,r=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function c(n,e){this._id=n,this._clearFn=e}f.setTimeout=function(){return new c(r.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(r.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},f.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},f._unrefActive=f.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},f.setImmediate="function"==typeof n?n:function(n){var e=u++,r=!(arguments.length<2)&&o.call(arguments,1);return i[e]=!0,t(function(){i[e]&&(r?n.apply(null,r):n.call(null),f.clearImmediate(e))}),e},f.clearImmediate="function"==typeof e?e:function(n){delete i[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,r){var t=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||t}},{"promise-polyfill":2}]},{},[4])(4)});var ot,it,ut=tt.exports.boltExport,ct=function(n){var r=E.none(),e=[],t=function(n){o()?u(n):e.push(n)},o=function(){return r.isSome()},i=function(n){M(n,u)},u=function(e){r.each(function(n){f.setTimeout(function(){e(n)},0)})};return n(function(n){r=E.some(n),i(e),e=[]}),{get:t,map:function(r){return ct(function(e){t(function(n){e(r(n))})})},isReady:o}},at={nu:ct,pure:function(e){return ct(function(n){n(e)})}},ft=function(n){f.setTimeout(function(){throw n},0)},st=function(r){var n=function(n){r().then(n,ft)};return{map:function(n){return st(function(){return r().then(n)})},bind:function(e){return st(function(){return r().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return st(function(){return r().then(function(){return n.toPromise()})})},toLazy:function(){return at.nu(n)},toCached:function(){var n=null;return st(function(){return null===n&&(n=r()),n})},toPromise:r,get:n}},lt=function(n){return st(function(){return new ut(n)})},dt=function(n){return st(function(){return ut.resolve(n)})},mt=function(i){return Q(Q({},i),{toCached:function(){return mt(i.toCached())},bindFuture:function(e){return mt(i.bind(function(n){return n.fold(function(n){return dt(hr.error(n))},function(n){return e(n)})}))},bindResult:function(e){return mt(i.map(function(n){return n.bind(e)}))},mapResult:function(e){return mt(i.map(function(n){return n.map(e)}))},mapError:function(e){return mt(i.map(function(n){return n.mapError(e)}))},foldResult:function(e,r){return i.map(function(n){return n.fold(e,r)})},withTimeout:function(n,o){return mt(lt(function(e){var r=!1,t=f.setTimeout(function(){r=!0,e(hr.error(o()))},n);i.get(function(n){r||(f.clearTimeout(t),e(n))})}))}})},pt=function(n){return mt(lt(n))},ht=function(n){return mt(dt(hr.value(n)))},vt={nu:pt,wrap:mt,pure:ht,value:ht,error:function(n){return mt(dt(hr.error(n)))},fromResult:function(n){return mt(dt(n))},fromFuture:function(n){return mt(n.map(hr.value))},fromPromise:function(n){return pt(function(e){n.then(function(n){e(hr.value(n))},function(n){e(hr.error(n))})})}},gt=function(){return(new Date).getTime()};(it=ot||(ot={})).JSON="json",it.Blob="blob",it.Text="text",it.FormData="formdata",it.MultipartFormData="multipart/form-data";var yt,wt,bt,Tt,xt,St,Et=function(n){try{var e=JSON.parse(n);return hr.value(e)}catch(n){return hr.error("Response was not JSON.")}},Ot=function(e){return lt(function(r){var n=new f.FileReader;n.onload=function(n){var e=n.target?n.target.result:new f.Blob([]);r(e)},n.readAsText(e)})},_t=function(n){return dt(n.response)},Nt=function(n,e){switch(n){case ot.JSON:return Et(e.response).fold(function(){return _t(e)},dt);case ot.Blob:return r=e,E.from(r.response).map(Ot).getOr(dt("no response content"));case ot.Text:default:return _t(e)}var r},Ct=function(i,n){return n.map(function(n){var r,t,e=(r=function(n,e){return encodeURIComponent(e)+"="+encodeURIComponent(n)},t=[],K(n,function(n,e){t.push(r(n,e))}),t),o=wn(i,"?")?"&":"?";return 0<e.length?i+o+e.join("&"):i}).getOr(i)},Dt=function(n){var e,r=(e=n.body,E.from(e).bind(function(n){switch(n.type){case ot.JSON:return E.some("application/json");case ot.FormData:return E.some("application/x-www-form-urlencoded; charset=UTF-8");case ot.MultipartFormData:return E.none();case ot.Text:default:return E.some("text/plain")}})),t=!0===n.credentials?E.some(!0):E.none(),o=function(n){switch(n){case ot.Blob:return"application/octet-stream";case ot.JSON:return"application/json, text/javascript";case ot.Text:return"text/plain";default:return""}}(n.responseType)+", */*; q=0.01",i=void 0!==n.headers?n.headers:{};return{contentType:r,responseType:function(n){switch(n){case ot.JSON:return E.none();case ot.Blob:return E.some("blob");case ot.Text:return E.some("text");default:return E.none()}}(n.responseType),credentials:t,accept:o,headers:i,progress:k(n.progress)?E.some(n.progress):E.none()}},kt=function(n){var r=new f.FormData;return K(n,function(n,e){r.append(e,n)}),r},At=function(c){return vt.nu(function(t){var o=new f.XMLHttpRequest;o.open(c.method,Ct(c.url,E.from(c.query)),!0);var r,n,e=Dt(c);r=o,(n=e).contentType.each(function(n){return r.setRequestHeader("Content-Type",n)}),r.setRequestHeader("Accept",n.accept),n.credentials.each(function(n){return r.withCredentials=n}),n.responseType.each(function(n){return r.responseType=n}),n.progress.each(function(e){return r.upload.addEventListener("progress",function(n){return e(n.loaded,n.total)})}),K(n.headers,function(n,e){return r.setRequestHeader(e,n)});var i,u=function(){var e,n,r;(e=c.url,n=c.responseType,r=o,Nt(n,r).map(function(n){return{message:0===r.status?"Unknown HTTP error (possible cross-domain request)":"Could not load url "+e+": "+r.statusText,status:r.status,responseText:n}})).get(function(n){return t(hr.error(n))})};o.onerror=u,o.onload=function(){0!==o.status||bn(c.url,"file:")?o.status<100||400<=o.status?u():function(n,e){var r=function(){return vt.pure(e.response)},t=function(n){return vt.error({message:n,status:e.status,responseText:e.responseText})};switch(n){case ot.JSON:return Et(e.response).fold(t,vt.pure);case ot.Blob:case ot.Text:return r();default:return t("unknown data type")}}(c.responseType,o).get(t):u()},(i=c.body,E.from(i).map(function(n){return n.type===ot.JSON?JSON.stringify(n.data):n.type===ot.FormData?kt(n.data):n.type===ot.MultipartFormData?kt(n.data):n})).fold(function(){return o.send()},function(n){o.send(n)})})},Rt=function(){return n="",{type:ot.Text,data:n};var n},It=function(n){return n.fold(function(n){var e=n.responseText,r=N(e)?e:n.message;return hr.error(r)},hr.value)},jt=function(s,l){var n,d=$(n=l,"tiny-api-key").orThunk(function(){return $(n,"tinymce-api-key")}).orThunk(function(){return $(n,"textbox-api-key")}).getOrUndefined();return{execute:function(n){var r,e,t,o,i,u,c=(r=function(n){return D(n)?String(n):n},z(n,function(n,e){return{k:e,v:r(n,e)}})),a=(i=c,e=s.replace(/\$\{([^{}]*)\}/g,function(n,e){var r,t=i[e];return"string"==(r=typeof t)||"number"===r?t.toString():n}),t=d,o=-1===e.indexOf("?")?"?":"&",t?e+o+"apiKey="+encodeURIComponent(t):e),f=(u={url:a,responseType:ot.JSON,credentials:!0,headers:l},At(Q(Q({},u),{method:"get",body:Rt()}))).map(It);return vt.wrap(f)}}},Ft=function(n){return Gr(n,n,Lr(),Xr())},Pt=function(n,e){return Gr(n,n,(r=e,Mr.defaultedThunk(y(r))),Xr());var r},Mt="iframely",Lt="oembed",Ut="fallback",Bt="wikipedia",Vt=function(n){return"["+n.join(", ")+"]"},Wt=[Mt,Lt,Ut],qt=function(e,n,r){return function(n,e){for(var r=0,t=n.length;r<t;r++)if(e(n[r],r))return!0;return!1}(n,function(n){return F(e,n)})?hr.error("Embed response source: "+Vt(e)+" contains more than one of "+Vt(Wt)):hr.value(r)},Ht=$r([Ft("url"),Ft("maxWidth"),Pt("fresh",!1)]),Jt=$r([Ft("status_code"),Ft("sub_code"),Ft("msg")]),Kt=$r([Ft("html"),(yt="rels",wt=[Gr("source","source",Lr(),(bt=function(n){return C(n)?F(e=n,Mt)?qt(e,[Lt,Ut,Bt],Mt):F(e,Lt)?qt(e,[Mt,Ut,Bt],Lt):F(e,Ut)?qt(e,[Mt,Lt,Bt],Ut):F(e,Bt)?qt(e,[Mt,Lt,Ut],Bt):hr.error("Embed response source: "+Vt(e)+" did not contain any of: "+Vt(Wt)):hr.error("Sources was not an array: "+n);var e},zr(function(n){return bt(n).fold(Or,Sr)})))],Gr(yt,yt,Lr(),$r(wt)))]),zt=function(n){return Zr("EmbedResponse.failure",Jt,n).fold(function(n){return hr.error({code:function(){return 600},subcode:function(){return 0},msg:function(){return et(n)}})},function(n){return hr.error({code:n.status_code,subcode:n.sub_code,msg:n.msg})})},$t=function(n){return Zr("EmbedResponse.success",Kt,n).fold(function(n){return hr.error({code:function(){return 601},subcode:function(){return 0},msg:function(){return et(n)}})},function(n){return hr.value({recommended:function(){return{html:n.html,source:n.rels().source}}})})},Xt=function(n,e,r){var s=function(n,r){void 0===r&&(r=36e5);var e,t,o={},i=function(n,e,r){o[n]={result:e,timestamp:r}},u=function(n,e){return n-e<r};return N(n)&&(e=n,t=gt(),K(e,function(n,e){u(t,n.timestamp)&&i(e,n.result,n.timestamp)})),{set:i,get:function(e,n){return E.from(o[n]).filter(function(n){return u(e,n.timestamp)}).map(function(n){return n.result})},dump:function(){return o}}}(r),l=jt(n+"/1/embed?url=${url}&maxWidth=${maxWidth}",e);return{checkOne:function(o,i,n){void 0===n&&(n=!1);var e,r,t,u,c,a=gt(),f=(e=function(n,e){var r={url:encodeURIComponent(o),maxWidth:i,fresh:e},t=nt("ephox.media.service.one.ajax.service.get",Ht,r);return l.execute(t)},r=s,t=i+"&"+o,u=a,(!0===(c=n)?E.none():r.get(u,t)).fold(function(){return e(t,c).mapResult(function(n){return r.set(t,n,u),n})},function(n){return vt.pure(n)}));return vt.wrap(f.map(function(n){return n.fold(zt,$t)}))},dumpCache:s.dump}},Yt=[Ft("url"),Pt("fresh",!1)],Gt=($r([Gr("urls","urls",Lr(),(Tt=Yt,Yr(Tt)))]),Rr([{invalid:["invalidUrl"]},{unknown:["unknownUrl"]},{valid:["validUrl"]}]),0),Qt=($r([Ft("language"),Ft("words")]),xt="good-spelling",St=(new Date).getTime(),Math.floor(1e9*Math.random()),++Gt,String(St),function(t){var n,e,o=(n=t.mediaembed_service_url,e=ae(t),Xt(n,e?{"tinymce-api-key":e}:{})),i=function(n,e,r){return o.checkOne(n,e,r)},u={};return{getOne:i,dumpCache:function(){o.dumpCache()},getAndHandleResponse:function(r,n,e){void 0!==u[r]?u[r]=u[r].concat(n):(u[r]=[n],i(r.trim(),ce(t)).get(function(n){return n.fold(function(n){e(n),delete u[r]},function(e){M(u[r],function(n){n(e)}),delete u[r]})}))}}}),Zt=function(t,o){var n=dr(t),e=Qt(t.settings);return ur(t),t.on("Init",function(){var n,e,r;e=o+"/content.min.css",r=fe((n=t).settings,e),n.dom.loadCSS(r)}),t.on("SkinLoaded",function(){ue(t.settings)?(tr(t,e,n),cr(t,e,n)):n.logError("You need to specify the mediaembed_service_url setting")}),{}},no=function(n,e){return tinymce.Env.ceFalse?p(tinymce,"4.5.2")?(fr.error("The mediaembed plugin requires at least 4.5.2 version of TinyMCE."),{}):Zt(n,e):{}};tinymce.PluginManager.add("mediaembed",no)}(window);